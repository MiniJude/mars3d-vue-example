/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.8.3
 * 编译日期：2024-09-22 12:59:44
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-08-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0x3303be,_0x5687d3){function _0x5e18c0(_0x2759a5,_0x2d8054){return _0x492e(_0x2d8054-0x334,_0x2759a5);}function _0x596476(_0x1b1b62,_0x50caf7){return _0x492e(_0x50caf7-0x2a,_0x1b1b62);}const _0x18f97=_0x3303be();while(!![]){try{const _0x2a897a=-parseInt(_0x596476(0x1ce,0x23f))/0x1*(-parseInt(_0x596476(0x251,0x1eb))/0x2)+parseInt(_0x596476(0x19e,0x1ee))/0x3+-parseInt(_0x596476(0x1a5,0x200))/0x4*(-parseInt(_0x5e18c0(0x48a,0x516))/0x5)+-parseInt(_0x596476(0x1a5,0x1a4))/0x6+-parseInt(_0x5e18c0(0x4c7,0x4ed))/0x7*(-parseInt(_0x596476(0x190,0x1b5))/0x8)+parseInt(_0x5e18c0(0x5bd,0x576))/0x9+-parseInt(_0x596476(0x210,0x27a))/0xa*(parseInt(_0x5e18c0(0x4a4,0x515))/0xb);if(_0x2a897a===_0x5687d3)break;else _0x18f97['push'](_0x18f97['shift']());}catch(_0x19f989){_0x18f97['push'](_0x18f97['shift']());}}}(_0x14d6,0x92768));function _interopNamespace(_0x275b44){if(_0x275b44&&_0x275b44['__esModule'])return _0x275b44;var _0xd9c801=Object[_0x20444e(-0x5b,-0x16)](null);function _0x37842d(_0x29a807,_0x201e0f){return _0x492e(_0x29a807-0x3d8,_0x201e0f);}_0x275b44&&Object['keys'](_0x275b44)[_0x37842d(0x53d,0x59b)](function(_0x761a5e){function _0x565de0(_0x40647b,_0x385bba){return _0x37842d(_0x385bba- -0x745,_0x40647b);}function _0x5a1350(_0x2c1a4b,_0x1112db){return _0x20444e(_0x2c1a4b,_0x1112db-0x5a1);}if(_0x761a5e!=='default'){var _0x5bc10c=Object['getOwnPropertyDescriptor'](_0x275b44,_0x761a5e);Object[_0x565de0(-0xf6,-0x13c)](_0xd9c801,_0x761a5e,_0x5bc10c[_0x5a1350(0x570,0x545)]?_0x5bc10c:{'enumerable':!![],'get':function(){return _0x275b44[_0x761a5e];}});}});function _0x20444e(_0x544b47,_0x512383){return _0x492e(_0x512383- -0x1ee,_0x544b47);}return _0xd9c801['default']=_0x275b44,_0xd9c801;}var mars3d__namespace=_interopNamespace(mars3d);const Cesium$7=mars3d__namespace[_0x448398(0x2db,0x2d0)];function getU(_0x1fd639,_0x592100){function _0x1a37f0(_0x5e6688,_0x3940ba){return _0x448398(_0x5e6688,_0x3940ba- -0x2b0);}const _0x3213fc=_0x1fd639*Math['cos'](Cesium$7['Math'][_0x1a37f0(0xad,0x50)](_0x592100));return _0x3213fc;}function getV(_0x561032,_0x44a240){function _0x5dd8b6(_0xbf86ed,_0x348554){return _0x448398(_0xbf86ed,_0x348554-0x20);}const _0x7935c2=_0x561032*Math['sin'](Cesium$7[_0x5dd8b6(0x274,0x299)]['toRadians'](_0x44a240));return _0x7935c2;}function getSpeed(_0x38c15f,_0x992c1a){function _0x39a3e3(_0x4e4032,_0x3ef070){return _0x448398(_0x3ef070,_0x4e4032- -0x341);}const _0x496430=Math['sqrt'](Math['pow'](_0x38c15f,0x2)+Math[_0x39a3e3(-0x63,-0x86)](_0x992c1a,0x2));return _0x496430;}function getDirection(_0x16f47f,_0x63e05b){let _0x471563=Cesium$7['Math']['toDegrees'](Math['atan2'](_0x63e05b,_0x16f47f));return _0x471563+=_0x471563<0x0?0x168:0x0,_0x471563;}const _0x45b463={};_0x45b463['__proto__']=null,_0x45b463['getU']=getU,_0x45b463['getV']=getV,_0x45b463[_0x448398(0x397,0x387)]=getSpeed,_0x45b463['getDirection']=getDirection;var WindUtil=_0x45b463;const Cesium$6=mars3d__namespace[_0x448398(0x270,0x2d0)];class CustomPrimitive{constructor(_0x4dfaa7){this['commandType']=_0x4dfaa7['commandType'],this['geometry']=_0x4dfaa7['geometry'],this[_0x40383f(-0xc5,-0x109)]=_0x4dfaa7['attributeLocations'],this['primitiveType']=_0x4dfaa7['primitiveType'];function _0x40383f(_0x51cd5f,_0x1a9c29){return _0x448398(_0x1a9c29,_0x51cd5f- -0x413);}this[_0x29073c(0x302,0x34f)]=_0x4dfaa7[_0x29073c(0x302,0x306)],this[_0x40383f(-0x14f,-0x142)]=_0x4dfaa7[_0x40383f(-0x14f,-0x127)],this['fragmentShaderSource']=_0x4dfaa7[_0x40383f(-0xc7,-0x82)],this[_0x29073c(0x359,0x380)]=_0x4dfaa7[_0x40383f(-0x93,-0x9b)],this['framebuffer']=_0x4dfaa7['framebuffer'],this['outputTexture']=_0x4dfaa7['outputTexture'],this['autoClear']=_0x4dfaa7['autoClear']??![],this[_0x29073c(0x326,0x2f0)]=_0x4dfaa7['preExecute'];function _0x29073c(_0x2c99ab,_0x1e9d84){return _0x448398(_0x1e9d84,_0x2c99ab- -0x27);}this['show']=!![],this['commandToExecute']=undefined,this['clearCommand']=undefined,this['autoClear']&&(this['clearCommand']=new Cesium$6[(_0x29073c(0x2d1,0x2c4))]({'color':new Cesium$6['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this['framebuffer'],'pass':Cesium$6[_0x40383f(-0x16e,-0x148)]['OPAQUE']}));}['createCommand'](_0x212daa){function _0x164ba2(_0x2e1b0a,_0x1f9f51){return _0x448398(_0x1f9f51,_0x2e1b0a- -0x38e);}function _0x16bff(_0x192b17,_0x1a03b5){return _0x4e6006(_0x1a03b5- -0x17f,_0x192b17);}switch(this['commandType']){case'Draw':{const _0x286157=Cesium$6['VertexArray']['fromGeometry']({'context':_0x212daa,'geometry':this['geometry'],'attributeLocations':this['attributeLocations'],'bufferUsage':Cesium$6[_0x164ba2(-0x1d,-0x83)][_0x16bff(0x3d6,0x40b)]}),_0x173bfd={};_0x173bfd['context']=_0x212daa,_0x173bfd['attributeLocations']=this['attributeLocations'],_0x173bfd['vertexShaderSource']=this['vertexShaderSource'],_0x173bfd['fragmentShaderSource']=this['fragmentShaderSource'];const _0x1beacf=Cesium$6[_0x16bff(0x4a5,0x438)][_0x16bff(0x44b,0x466)](_0x173bfd),_0x1c0e72=Cesium$6[_0x164ba2(-0x64,-0x27)][_0x16bff(0x4a6,0x466)](this[_0x164ba2(-0xe,-0x6a)]);return new Cesium$6['DrawCommand']({'owner':this,'vertexArray':_0x286157,'primitiveType':this['primitiveType'],'uniformMap':this[_0x16bff(0x3f2,0x446)],'modelMatrix':Cesium$6['Matrix4'][_0x16bff(0x4d8,0x481)],'shaderProgram':_0x1beacf,'framebuffer':this['framebuffer'],'renderState':_0x1c0e72,'pass':Cesium$6['Pass'][_0x16bff(0x436,0x427)]});}case'Compute':{const _0x1b8316={};return _0x1b8316[_0x16bff(0x3a5,0x3e4)]=this,_0x1b8316['fragmentShaderSource']=this['fragmentShaderSource'],_0x1b8316[_0x164ba2(-0x65,-0xd3)]=this[_0x16bff(0x3d4,0x446)],_0x1b8316[_0x164ba2(-0xb3,-0x9a)]=this['outputTexture'],_0x1b8316['persists']=!![],new Cesium$6['ComputeCommand'](_0x1b8316);}}}['setGeometry'](_0x370402,_0x56640a){function _0x21a385(_0x47d3a2,_0x12ea59){return _0x4e6006(_0x12ea59- -0x193,_0x47d3a2);}function _0x55a221(_0x4dcb2d,_0xfe0e01){return _0x448398(_0x4dcb2d,_0xfe0e01- -0x21b);}this['geometry']=_0x56640a;const _0x4ad6c4=Cesium$6[_0x21a385(0x419,0x3c2)]['fromGeometry']({'context':_0x370402,'geometry':this['geometry'],'attributeLocations':this['attributeLocations'],'bufferUsage':Cesium$6[_0x55a221(0x1d6,0x156)][_0x55a221(0x11b,0xd3)]});this['commandToExecute'][_0x55a221(0x99,0x11a)]=_0x4ad6c4;}['update'](_0x3c9210){if(!this[_0x276ab9(0x505,0x4ab)])return;function _0x3b92ad(_0x205e9f,_0x2ef03d){return _0x4e6006(_0x205e9f- -0x122,_0x2ef03d);}if(_0x3c9210[_0x3b92ad(0x4be,0x47a)]!==Cesium$6['SceneMode'][_0x276ab9(0x520,0x4e5)])return;!Cesium$6['defined'](this[_0x276ab9(0x580,0x4f8)])&&(this['commandToExecute']=this['createCommand'](_0x3c9210['context']));Cesium$6['defined'](this['preExecute'])&&this[_0x3b92ad(0x4c7,0x550)]();function _0x276ab9(_0x3a0137,_0x11ae22){return _0x448398(_0x11ae22,_0x3a0137-0x1fa);}Cesium$6['defined'](this['clearCommand'])&&_0x3c9210[_0x276ab9(0x4eb,0x4c3)]['push'](this[_0x3b92ad(0x4f6,0x48e)]),_0x3c9210[_0x276ab9(0x4eb,0x501)]['push'](this[_0x3b92ad(0x500,0x475)]);}['isDestroyed'](){return![];}['destroy'](){if(this['clearCommand']){var _0x4ae725,_0x1a1a56;(_0x4ae725=this[_0x410776(-0x73,0x3)])!==null&&_0x4ae725!==void 0x0&&_0x4ae725['vertexArray']&&this['clearCommand']['vertexArray']['destroy'](),(_0x1a1a56=this[_0x41fac2(0x34f,0x35d)])!==null&&_0x1a1a56!==void 0x0&&_0x1a1a56['shaderProgram']&&this['clearCommand']['shaderProgram']['destroy'](),delete this[_0x41fac2(0x34f,0x317)];}function _0x410776(_0x5b724a,_0x440c3d){return _0x4e6006(_0x440c3d- -0x615,_0x5b724a);}this['commandToExecute']&&(this[_0x410776(0x1b,0xd)][_0x41fac2(0x308,0x2b1)]&&this[_0x410776(0x2,0xd)]['vertexArray']['destroy'](),this[_0x410776(0x91,0xd)]['shaderProgram']&&this['commandToExecute']['shaderProgram']['destroy'](),delete this[_0x41fac2(0x359,0x3d6)]);function _0x41fac2(_0x2ecf02,_0x4daecf){return _0x4e6006(_0x2ecf02- -0x2c9,_0x4daecf);}return Cesium$6['destroyObject'](this);}}const Cesium$5=mars3d__namespace[_0x4e6006(0x56c,0x5ca)],Util=(function(){const _0x4e0537=function(){const _0x5a10b1=new Cesium$5['Geometry']({'attributes':new Cesium$5['GeometryAttributes']({'position':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x3,'values':new Float32Array([-0x1,-0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0,-0x1,0x1,0x0])}),'st':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5['ComponentDatatype'][_0x1f689c(0x27b,0x22e)],'componentsPerAttribute':0x2,'values':new Float32Array([0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x1])})}),'indices':new Uint32Array([0x3,0x2,0x0,0x0,0x2,0x1])});function _0x1f689c(_0x285499,_0x45ea7a){return _0x492e(_0x45ea7a- -0x25,_0x285499);}return _0x5a10b1;};function _0x307975(_0x36746f,_0x5835a6){return _0x4e6006(_0x36746f- -0x39b,_0x5835a6);}const _0x40bcd9=function(_0x2933fe,_0xdb75e1){if(Cesium$5['defined'](_0xdb75e1)){const _0x2a1682={};_0x2a1682['arrayBufferView']=_0xdb75e1,_0x2933fe['source']=_0x2a1682;}const _0x3c2c60=new Cesium$5['Texture'](_0x2933fe);return _0x3c2c60;},_0xfff6ec=function(_0xbc3f0,_0xe09ad3,_0x194f67){const _0x43ea54={};_0x43ea54[_0x354b00(-0x11d,-0x118)]=_0xbc3f0,_0x43ea54['colorTextures']=[_0xe09ad3];function _0x354b00(_0x83e4f8,_0x1b98a3){return _0x492e(_0x83e4f8- -0x2aa,_0x1b98a3);}_0x43ea54['depthTexture']=_0x194f67;const _0x514a81=new Cesium$5['Framebuffer'](_0x43ea54);return _0x514a81;},_0x77c9e0=function(_0x400edb){const _0x10c3ad=!![],_0x2d838b=![],_0x438565={};_0x438565['viewport']=_0x400edb[_0x222df9(0x569,0x510)],_0x438565['depthTest']=_0x400edb[_0x49ec03(-0x116,-0x14a)];function _0x49ec03(_0x16d8b8,_0x1fbe1c){return _0x492e(_0x16d8b8- -0x327,_0x1fbe1c);}_0x438565['depthMask']=_0x400edb['depthMask'];function _0x222df9(_0x1c933d,_0x5dd664){return _0x492e(_0x5dd664-0x394,_0x1c933d);}_0x438565[_0x222df9(0x50c,0x567)]=_0x400edb[_0x222df9(0x5dc,0x567)];const _0x335ae2=_0x438565,_0x2a478b=Cesium$5['Appearance']['getDefaultRenderState'](_0x10c3ad,_0x2d838b,_0x335ae2);return _0x2a478b;},_0x4eeeb1=function(_0x2b5add){const _0x124ac1={},_0x481a08=Cesium$5['Math']['mod'](_0x2b5add['west'],Cesium$5['Math']['TWO_PI']),_0x3442ad=Cesium$5[_0x149fb4(-0x1bb,-0x22c)]['mod'](_0x2b5add['east'],Cesium$5['Math']['TWO_PI']),_0x4ea4e4=_0x2b5add['width'];let _0x1a20cb,_0x388a80;_0x4ea4e4>Cesium$5['Math']['THREE_PI_OVER_TWO']?(_0x1a20cb=0x0,_0x388a80=Cesium$5[_0x149fb4(-0x208,-0x22c)]['TWO_PI']):_0x3442ad-_0x481a08<_0x4ea4e4?(_0x1a20cb=_0x481a08,_0x388a80=_0x481a08+_0x4ea4e4):(_0x1a20cb=_0x481a08,_0x388a80=_0x3442ad);function _0x149fb4(_0x4d221c,_0x1266db){return _0x492e(_0x1266db- -0x374,_0x4d221c);}_0x124ac1['lon']={'min':Cesium$5['Math']['toDegrees'](_0x1a20cb),'max':Cesium$5['Math']['toDegrees'](_0x388a80)};const _0x1aa097=_0x2b5add['south'],_0x34c528=_0x2b5add['north'],_0x4cf841=_0x2b5add[_0xe71757(0x95,0xbf)];function _0xe71757(_0xa9dfe5,_0x1f725a){return _0x492e(_0x1f725a- -0x186,_0xa9dfe5);}const _0x5cbe7b=_0x4cf841>Cesium$5['Math']['PI']/0xc?_0x4cf841/0x2:0x0;let _0x2a3e4e=Cesium$5['Math']['clampToLatitudeRange'](_0x1aa097-_0x5cbe7b),_0x73cc0c=Cesium$5['Math']['clampToLatitudeRange'](_0x34c528+_0x5cbe7b);return _0x2a3e4e<-Cesium$5[_0x149fb4(-0x257,-0x22c)]['PI_OVER_THREE']&&(_0x2a3e4e=-Cesium$5[_0xe71757(-0xc6,-0x3e)]['PI_OVER_TWO']),_0x73cc0c>Cesium$5[_0xe71757(0x49,-0x3e)]['PI_OVER_THREE']&&(_0x73cc0c=Cesium$5['Math'][_0x149fb4(-0xc3,-0x139)]),_0x124ac1['lat']={'min':Cesium$5[_0x149fb4(-0x236,-0x22c)]['toDegrees'](_0x2a3e4e),'max':Cesium$5[_0xe71757(0x35,-0x3e)][_0x149fb4(-0x231,-0x1d2)](_0x73cc0c)},_0x124ac1;},_0x328673={};function _0x36f113(_0x2dcf8e,_0x2064bb){return _0x448398(_0x2dcf8e,_0x2064bb- -0x2e8);}return _0x328673['getFullscreenQuad']=_0x4e0537,_0x328673[_0x36f113(0x29,0x8a)]=_0x40bcd9,_0x328673[_0x36f113(0x29,-0x51)]=_0xfff6ec,_0x328673['createRawRenderState']=_0x77c9e0,_0x328673['viewRectangleToLonLatRange']=_0x4eeeb1,_0x328673;}());var fullscreenVert='#version\x20300\x20es\x0a\x0ain\x20vec3\x20position;\x0ain\x20vec2\x20st;\x0a\x0aout\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20textureCoordinate\x20=\x20st;\x0a\x20\x20gl_Position\x20=\x20vec4(position,\x201.0f);\x0a}\x0a',screenDrawFrag=_0x4e6006(0x5f8,0x5c2),segmentDrawFrag='#version\x20300\x20es\x0a\x0auniform\x20sampler2D\x20colorTable;\x0auniform\x20bool\x20colour;\x0a\x0ain\x20float\x20heightNormalization;\x0ain\x20float\x20speedNormalization;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20const\x20float\x20zero\x20=\x200.0f;\x0a\x20\x20if(speedNormalization\x20>\x20zero)\x20{\x0a\x20\x20\x20\x20if(colour)\x20{\x0a\x20\x20\x20\x20\x20\x20fragColor\x20=\x20texture(colorTable,\x20vec2(heightNormalization,\x20zero));\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20fragColor\x20=\x20texture(colorTable,\x20vec2(speedNormalization,\x20zero));\x0a\x20\x20\x20\x20}\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a}\x0a',segmentDrawVert=_0x448398(0x27d,0x2a8),trailDrawFrag=_0x448398(0x24f,0x294);const Cesium$4=mars3d__namespace['Cesium'];class ParticlesRendering{constructor(_0x3385e5,_0x567c89,_0x57e603,_0x380ccc,_0x4ad9b8){function _0x5448ea(_0x2da9a2,_0x527da6){return _0x448398(_0x2da9a2,_0x527da6- -0x291);}this['colour']=_0x57e603['colors']==='height',this['createRenderingTextures'](_0x3385e5,_0x567c89,_0x57e603['colors']),this['createRenderingFramebuffers'](_0x3385e5),this[_0x5448ea(0x83,0x41)](_0x3385e5,_0x567c89,_0x57e603,_0x380ccc,_0x4ad9b8);}['createRenderingTextures'](_0x7a0b50,_0x11d5a5,_0x43beca){const _0x59f3da={};_0x59f3da['context']=_0x7a0b50,_0x59f3da['width']=_0x7a0b50['drawingBufferWidth'],_0x59f3da[_0x3769d1(-0x3d,-0x4b)]=_0x7a0b50[_0x2c2f28(0x4e3,0x4f7)],_0x59f3da[_0x2c2f28(0x3b2,0x42c)]=Cesium$4['PixelFormat'][_0x3769d1(-0x104,-0xed)],_0x59f3da['pixelDatatype']=Cesium$4['PixelDatatype']['UNSIGNED_BYTE'];function _0x3769d1(_0x2cd731,_0x344671){return _0x448398(_0x344671,_0x2cd731- -0x3b3);}const _0x39d2ff=_0x59f3da,_0x1bc68e={};_0x1bc68e['context']=_0x7a0b50,_0x1bc68e['width']=_0x7a0b50['drawingBufferWidth'],_0x1bc68e['height']=_0x7a0b50['drawingBufferHeight'],_0x1bc68e['pixelFormat']=Cesium$4[_0x2c2f28(0x46c,0x48b)]['DEPTH_COMPONENT'],_0x1bc68e['pixelDatatype']=Cesium$4[_0x3769d1(-0xda,-0x7c)][_0x2c2f28(0x3e9,0x41a)];const _0xa3e141=_0x1bc68e,_0x55e214=_0x43beca['length'],_0x40bc95=new Float32Array(_0x55e214*0x3);for(let _0x48c202=0x0;_0x48c202<_0x55e214;_0x48c202++){const _0x26a6aa=Cesium$4[_0x2c2f28(0x50b,0x4f5)]['fromCssColorString'](_0x43beca[_0x48c202]);_0x40bc95[0x3*_0x48c202]=_0x26a6aa['red'],_0x40bc95[0x3*_0x48c202+0x1]=_0x26a6aa[_0x2c2f28(0x4c2,0x450)],_0x40bc95[0x3*_0x48c202+0x2]=_0x26a6aa['blue'];}function _0x2c2f28(_0x4ac25c,_0x2392af){return _0x448398(_0x4ac25c,_0x2392af-0x19f);}const _0x84686e={'context':_0x7a0b50,'width':_0x55e214,'height':0x1,'pixelFormat':Cesium$4['PixelFormat'][_0x3769d1(-0x139,-0x11c)],'pixelDatatype':Cesium$4[_0x3769d1(-0xda,-0x119)]['FLOAT'],'sampler':new Cesium$4['Sampler']({'minificationFilter':Cesium$4['TextureMinificationFilter']['LINEAR'],'magnificationFilter':Cesium$4[_0x3769d1(-0xfb,-0x73)][_0x2c2f28(0x4a7,0x522)]})};this['textures']={'segmentsColor':Util['createTexture'](_0x39d2ff),'segmentsDepth':Util[_0x2c2f28(0x4e4,0x511)](_0xa3e141),'currentTrailsColor':Util['createTexture'](_0x39d2ff),'currentTrailsDepth':Util['createTexture'](_0xa3e141),'nextTrailsColor':Util['createTexture'](_0x39d2ff),'nextTrailsDepth':Util['createTexture'](_0xa3e141),'colorTable':Util[_0x3769d1(-0x41,0x2a)](_0x84686e,_0x40bc95)};}[_0x4e6006(0x598,0x535)](_0x3c70dc){function _0x193650(_0x33200c,_0x1afda9){return _0x448398(_0x33200c,_0x1afda9-0x199);}function _0x4f9507(_0x559352,_0x2fa8b6){return _0x4e6006(_0x2fa8b6- -0x2bf,_0x559352);}this['framebuffers']={'segments':Util['createFramebuffer'](_0x3c70dc,this[_0x4f9507(0x30b,0x2c2)]['segmentsColor'],this['textures'][_0x193650(0x486,0x41e)]),'currentTrails':Util[_0x4f9507(0x2b6,0x274)](_0x3c70dc,this[_0x4f9507(0x34e,0x2c2)][_0x4f9507(0x3c7,0x34d)],this['textures']['currentTrailsDepth']),'nextTrails':Util[_0x4f9507(0x213,0x274)](_0x3c70dc,this[_0x193650(0x4de,0x47e)]['nextTrailsColor'],this['textures']['nextTrailsDepth'])};}[_0x448398(0x385,0x389)](_0x1a84b9){const _0x958f73=0x4;let _0x161567=[];for(let _0x3acf17=0x0;_0x3acf17<_0x1a84b9['particlesTextureSize'];_0x3acf17++){for(let _0x283ffc=0x0;_0x283ffc<_0x1a84b9['particlesTextureSize'];_0x283ffc++){for(let _0x5d70a6=0x0;_0x5d70a6<_0x958f73;_0x5d70a6++){_0x161567['push'](_0x3acf17/_0x1a84b9[_0x2d07c1(0x2bb,0x29e)]),_0x161567[_0x2d07c1(0x3b4,0x41c)](_0x283ffc/_0x1a84b9[_0x2d07c1(0x2bb,0x248)]);}}}_0x161567=new Float32Array(_0x161567);function _0x314a3f(_0x13f9cd,_0x443090){return _0x4e6006(_0x443090- -0x5dc,_0x13f9cd);}let _0x30f05b=[];for(let _0x47c2bc=0x0;_0x47c2bc<_0x1a84b9['maxParticles'];_0x47c2bc++){_0x30f05b[_0x314a3f(0x76,0x2d)](-0x1,-0x1,0x0,-0x1,0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0);}_0x30f05b=new Float32Array(_0x30f05b);let _0x1e2aa2=[];for(let _0x4d0174=0x0,_0xfe3fe2=0x0;_0x4d0174<_0x1a84b9[_0x314a3f(-0x61,0x19)];_0x4d0174++){_0x1e2aa2['push'](_0xfe3fe2+0x0,_0xfe3fe2+0x1,_0xfe3fe2+0x2,_0xfe3fe2+0x2,_0xfe3fe2+0x1,_0xfe3fe2+0x3),_0xfe3fe2+=_0x958f73;}_0x1e2aa2=new Uint32Array(_0x1e2aa2);function _0x2d07c1(_0x2acf27,_0x4bb519){return _0x4e6006(_0x2acf27- -0x255,_0x4bb519);}const _0x39f87c=new Cesium$4[(_0x314a3f(-0x24,-0x23))]({'attributes':new Cesium$4['GeometryAttributes']({'st':new Cesium$4[(_0x314a3f(-0x49,0x1a))]({'componentDatatype':Cesium$4[_0x2d07c1(0x381,0x304)]['FLOAT'],'componentsPerAttribute':0x2,'values':_0x161567}),'normal':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x3,'values':_0x30f05b})}),'indices':_0x1e2aa2});return _0x39f87c;}[_0x4e6006(0x56e,0x5d8)](_0x4e4d11,_0x27ef34,_0x2a639a,_0x516214,_0x193e9e){const _0x35fa0d=this,_0x23921e={};_0x23921e['st']=0x0,_0x23921e['normal']=0x1;const _0x1b9ee3={};_0x1b9ee3['sources']=[segmentDrawVert];const _0x318cfc={};function _0x42859b(_0x1a1fff,_0xb55bfd){return _0x448398(_0xb55bfd,_0x1a1fff-0x234);}_0x318cfc['sources']=[segmentDrawFrag];const _0x476d17={};_0x476d17['enabled']=!![];const _0x5323ea={};_0x5323ea['viewport']=undefined,_0x5323ea[_0x42859b(0x576,0x59f)]=_0x476d17,_0x5323ea['depthMask']=!![];const _0x5607f2={};_0x5607f2['position']=0x0,_0x5607f2['st']=0x1;const _0x2b12f4={};_0x2b12f4['defines']=[_0x42859b(0x50a,0x511)],_0x2b12f4[_0x42859b(0x4bf,0x513)]=[fullscreenVert];const _0xca3b79={};function _0x52d510(_0x57e61f,_0x7f83c4){return _0x4e6006(_0x57e61f- -0x4c,_0x7f83c4);}_0xca3b79['defines']=['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],_0xca3b79[_0x52d510(0x4db,0x558)]=[trailDrawFrag];const _0x25a66b={};_0x25a66b[_0x42859b(0x540,0x535)]=0x0,_0x25a66b['st']=0x1;const _0x38e7d3={};_0x38e7d3[_0x52d510(0x5b0,0x53e)]=['DISABLE_GL_POSITION_LOG_DEPTH'],_0x38e7d3[_0x52d510(0x4db,0x521)]=[fullscreenVert];const _0x4c2c40={};_0x4c2c40['defines']=[_0x52d510(0x588,0x608)],_0x4c2c40[_0x42859b(0x4bf,0x4ba)]=[screenDrawFrag];const _0x20569d={};_0x20569d['enabled']=![];const _0x6ed1a2={};_0x6ed1a2[_0x42859b(0x57c,0x5f3)]=!![],this['primitives']={'segments':new CustomPrimitive({'commandType':_0x42859b(0x589,0x5a0),'attributeLocations':_0x23921e,'geometry':this[_0x52d510(0x5d9,0x553)](_0x2a639a),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'previousParticlesPosition':function(){return _0x193e9e['particlesTextures']['previousParticlesPosition'];},'currentParticlesPosition':function(){return _0x193e9e['particlesTextures']['currentParticlesPosition'];},'postProcessingPosition':function(){function _0x3089e3(_0x1de2da,_0x570cc5){return _0x52d510(_0x1de2da- -0x2ce,_0x570cc5);}return _0x193e9e[_0x3089e3(0x209,0x26d)]['postProcessingPosition'];},'particlesSpeed':function(){function _0x32a3f5(_0x5ec6f5,_0x3c91b8){return _0x42859b(_0x3c91b8- -0x502,_0x5ec6f5);}return _0x193e9e[_0x32a3f5(-0x6e,-0x47)]['particlesSpeed'];},'colorTable':function(){return _0x35fa0d['textures']['colorTable'];},'aspect':function(){function _0x10d415(_0x4bbbf4,_0x354d37){return _0x42859b(_0x354d37- -0x133,_0x4bbbf4);}return _0x4e4d11['drawingBufferWidth']/_0x4e4d11[_0x10d415(0x3d4,0x459)];},'H':function(){return _0x27ef34['H']['array'];},'hRange':function(){function _0x243535(_0x2af2d2,_0x45f708){return _0x42859b(_0x2af2d2- -0x335,_0x45f708);}function _0x56c103(_0x258a08,_0x16d189){return _0x52d510(_0x16d189- -0x266,_0x258a08);}return new Cesium$4[(_0x243535(0x1ea,0x15f))](_0x27ef34['H']['min'],_0x27ef34['H'][_0x243535(0x18d,0x10b)]);},'uSpeedRange':function(){function _0x3e516d(_0x5ac150,_0x274898){return _0x52d510(_0x5ac150- -0x62a,_0x274898);}function _0x18763b(_0x2db91e,_0x29a11b){return _0x42859b(_0x29a11b-0x46,_0x2db91e);}return new Cesium$4[(_0x3e516d(-0xef,-0xae))](_0x27ef34['U'][_0x18763b(0x584,0x51b)],_0x27ef34['U']['max']);},'vSpeedRange':function(){function _0x18c45c(_0x1b2545,_0x12d770){return _0x42859b(_0x1b2545- -0x42b,_0x12d770);}return new Cesium$4[(_0x18c45c(0xf4,0x8d))](_0x27ef34['V']['min'],_0x27ef34['V']['max']);},'wSpeedRange':function(){function _0x3893a6(_0x3b307e,_0x1c55cc){return _0x52d510(_0x3b307e- -0x527,_0x1c55cc);}return new Cesium$4['Cartesian2'](_0x27ef34['W']['min'],_0x27ef34['W'][_0x3893a6(-0x49,-0x95)]);},'pixelSize':function(){return _0x516214['pixelSize'];},'lineWidth':function(){function _0x469fc8(_0x271084,_0x176f67){return _0x52d510(_0x271084- -0x20a,_0x176f67);}return _0x2a639a[_0x469fc8(0x373,0x383)];},'particleHeight':function(){return _0x2a639a['particleHeight'];},'colour':function(){return _0x35fa0d['colour'];}},'vertexShaderSource':new Cesium$4[(_0x42859b(0x579,0x502))](_0x1b9ee3),'fragmentShaderSource':new Cesium$4[(_0x52d510(0x595,0x61d))](_0x318cfc),'rawRenderState':Util[_0x42859b(0x4d0,0x519)](_0x5323ea),'framebuffer':this[_0x52d510(0x568,0x5d2)]['segments'],'autoClear':!![]}),'trails':new CustomPrimitive({'commandType':'Draw','attributeLocations':_0x5607f2,'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'segmentsColorTexture':function(){return _0x35fa0d['textures']['segmentsColor'];},'segmentsDepthTexture':function(){function _0x1a62fe(_0x50b05f,_0xaa17f2){return _0x52d510(_0x50b05f- -0x686,_0xaa17f2);}function _0x3de047(_0x3dbbcf,_0x5537bc){return _0x42859b(_0x3dbbcf- -0x279,_0x5537bc);}return _0x35fa0d[_0x1a62fe(-0x151,-0x147)][_0x1a62fe(-0x1b1,-0x222)];},'currentTrailsColor':function(){function _0x462fcd(_0xd0dc39,_0x48effa){return _0x52d510(_0xd0dc39- -0x284,_0x48effa);}function _0x2b105b(_0x5cc28d,_0x386761){return _0x42859b(_0x5cc28d- -0x499,_0x386761);}return _0x35fa0d[_0x462fcd(0x2e4,0x35c)][_0x462fcd(0x32d,0x327)]['getColorTexture'](0x0);},'trailsDepthTexture':function(){function _0x40cb83(_0x498a09,_0x178c64){return _0x52d510(_0x498a09- -0x419,_0x178c64);}function _0x485e21(_0x488300,_0x33b0a9){return _0x42859b(_0x488300- -0x5e,_0x33b0a9);}return _0x35fa0d[_0x485e21(0x4ee,0x469)][_0x40cb83(0x198,0x173)][_0x40cb83(0x12a,0x128)];},'fadeOpacity':function(){return _0x2a639a['fadeOpacity'];}},'vertexShaderSource':new Cesium$4['ShaderSource'](_0x2b12f4),'fragmentShaderSource':new Cesium$4[(_0x42859b(0x579,0x5fb))](_0xca3b79),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':{'enabled':!![],'func':Cesium$4['DepthFunction'][_0x42859b(0x593,0x509)]},'depthMask':!![]}),'framebuffer':this['framebuffers'][_0x42859b(0x567,0x576)],'autoClear':!![],'preExecute':function(){function _0x253b5f(_0x269ea8,_0xaf2842){return _0x52d510(_0xaf2842- -0x716,_0x269ea8);}if(_0x2a639a[_0x253b5f(-0x230,-0x228)]){const _0x1820bc=_0x35fa0d[_0x263276(0x311,0x362)]['currentTrails'];_0x35fa0d['framebuffers']['currentTrails']=_0x35fa0d[_0x263276(0x311,0x315)]['nextTrails'],_0x35fa0d['framebuffers'][_0x263276(0x32c,0x370)]=_0x1820bc;}function _0x263276(_0x45be61,_0x35f6ae){return _0x52d510(_0x45be61- -0x257,_0x35f6ae);}_0x35fa0d[_0x263276(0x27b,0x2cd)]['trails']['commandToExecute']['framebuffer']=_0x35fa0d['framebuffers']['nextTrails'],_0x35fa0d[_0x263276(0x27b,0x273)][_0x253b5f(-0x1b9,-0x23a)]['clearCommand'][_0x253b5f(-0x203,-0x214)]=_0x35fa0d['framebuffers']['nextTrails'];}}),'screen':new CustomPrimitive({'commandType':_0x52d510(0x5a5,0x56b),'attributeLocations':_0x25a66b,'geometry':Util[_0x52d510(0x51a,0x4ef)](),'primitiveType':Cesium$4[_0x42859b(0x4c4,0x4e7)]['TRIANGLES'],'uniformMap':{'trailsColorTexture':function(){function _0x10bf55(_0x4bfa7f,_0xa5f219){return _0x52d510(_0x4bfa7f- -0x51a,_0xa5f219);}return _0x35fa0d[_0x10bf55(0x4e,0x71)]['nextTrails']['getColorTexture'](0x0);},'trailsDepthTexture':function(){function _0x149398(_0x29739e,_0x1ac2ee){return _0x42859b(_0x1ac2ee-0x24,_0x29739e);}function _0x471776(_0x423ce4,_0x36a6af){return _0x42859b(_0x423ce4-0x5,_0x36a6af);}return _0x35fa0d[_0x149398(0x558,0x570)][_0x149398(0x607,0x58b)][_0x149398(0x564,0x54b)];}},'vertexShaderSource':new Cesium$4['ShaderSource'](_0x38e7d3),'fragmentShaderSource':new Cesium$4[(_0x52d510(0x595,0x5d0))](_0x4c2c40),'rawRenderState':Util[_0x42859b(0x4d0,0x53c)]({'viewport':undefined,'depthTest':_0x20569d,'depthMask':!![],'blending':_0x6ed1a2}),'framebuffer':undefined})};}}var CalculateSpeedShader='#version\x20300\x20es\x0a\x0a//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat*lev\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0auniform\x20sampler2D\x20W;\x20//\x20upward\x20wind\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0a//\x20used\x20to\x20calculate\x20the\x20wind\x20norm\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20vec2\x20wSpeedRange;\x0auniform\x20float\x20speedScaleFactor;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLatLev.x\x20=\x20clamp(lonLatLev.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20minimum.y,\x20maximum.y);\x0a\x20\x20lonLatLev.z\x20=\x20clamp(lonLatLev.z,\x20minimum.z,\x20maximum.z);\x0a\x0a\x20\x20vec3\x20index3D\x20=\x20vec3(0.0f);\x0a\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20\x20\x20//\x20map\x20the\x20z-axis\x20value\x20to\x20the\x20nearest\x20bit\x20plane\x20to\x20ensure\x20that\x20the\x20result\x20is\x20an\x20integer\x0a\x20\x20index3D.z\x20=\x20ceil((lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z);\x0a\x0a\x20\x20\x20\x20//\x20the\x20st\x20texture\x20coordinate\x20corresponding\x20to\x20(col,\x20row)\x20index\x0a\x20\x20\x20\x20//\x20example\x0a\x20\x20\x20\x20//\x20data\x20array\x20is\x20[0,\x201,\x202,\x203,\x204,\x205,\x207,\x208,\x209],\x20width\x20=\x202,\x20height\x20=\x202,\x20level\x20=\x202\x0a\x20\x20\x20\x20//\x20the\x20content\x20of\x20texture\x20will\x20be\x0a\x20\x20\x20\x20//\x20t\x201.0\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x206\x207\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x204\x205\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x202\x203\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x200\x201\x0a\x20\x20\x20\x20//\x20\x20\x200.0------1.0\x20s\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWindComponent(sampler2D\x20componentTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20float\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20result;\x0a}\x0a\x0afloat\x20interpolateTexture(sampler2D\x20componentTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20float\x20lon\x20=\x20lonLatLev.x;\x0a\x20\x20float\x20lat\x20=\x20lonLatLev.y;\x0a\x20\x20float\x20lev\x20=\x20lonLatLev.z;\x0a\x0a\x20\x20float\x20lon0\x20=\x20floor(lon\x20/\x20interval.x)\x20*\x20interval.x;\x0a\x20\x20float\x20lon1\x20=\x20lon0\x20+\x201.0f\x20*\x20interval.x;\x0a\x20\x20float\x20lat0\x20=\x20floor(lat\x20/\x20interval.y)\x20*\x20interval.y;\x0a\x20\x20float\x20lat1\x20=\x20lat0\x20+\x201.0f\x20*\x20interval.y;\x0a\x0a\x20\x20float\x20lon0_lat0\x20=\x20getWindComponent(componentTexture,\x20vec3(lon0,\x20lat0,\x20lev));\x0a\x20\x20float\x20lon1_lat0\x20=\x20getWindComponent(componentTexture,\x20vec3(lon1,\x20lat0,\x20lev));\x0a\x20\x20float\x20lon0_lat1\x20=\x20getWindComponent(componentTexture,\x20vec3(lon0,\x20lat1,\x20lev));\x0a\x20\x20float\x20lon1_lat1\x20=\x20getWindComponent(componentTexture,\x20vec3(lon1,\x20lat1,\x20lev));\x0a\x0a\x20\x20float\x20lon_lat0\x20=\x20mix(lon0_lat0,\x20lon1_lat0,\x20lon\x20-\x20lon0);\x0a\x20\x20float\x20lon_lat1\x20=\x20mix(lon0_lat1,\x20lon1_lat1,\x20lon\x20-\x20lon0);\x0a\x20\x20float\x20lon_lat\x20=\x20mix(lon_lat0,\x20lon_lat1,\x20lat\x20-\x20lat0);\x0a\x20\x20return\x20lon_lat;\x0a}\x0a\x0avec3\x20linearInterpolation(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20https://en.wikipedia.org/wiki/Bilinear_interpolation\x0a\x20\x20float\x20u\x20=\x20interpolateTexture(U,\x20lonLatLev);\x0a\x20\x20float\x20v\x20=\x20interpolateTexture(V,\x20lonLatLev);\x0a\x20\x20float\x20w\x20=\x20interpolateTexture(W,\x20lonLatLev);\x0a\x20\x20return\x20vec3(u,\x20v,\x20w);\x0a}\x0a\x0avec2\x20lengthOfLonLat(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x0a\x20\x20float\x20term1\x20=\x20111132.92f;\x0a\x20\x20float\x20term2\x20=\x20559.82f\x20*\x20cos(2.0f\x20*\x20latitude);\x0a\x20\x20float\x20term3\x20=\x201.175f\x20*\x20cos(4.0f\x20*\x20latitude);\x0a\x20\x20float\x20term4\x20=\x200.0023f\x20*\x20cos(6.0f\x20*\x20latitude);\x0a\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20float\x20term5\x20=\x20111412.84f\x20*\x20cos(latitude);\x0a\x20\x20float\x20term6\x20=\x2093.5f\x20*\x20cos(3.0f\x20*\x20latitude);\x0a\x20\x20float\x20term7\x20=\x200.118f\x20*\x20cos(5.0f\x20*\x20latitude);\x0a\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avec3\x20convertSpeedUnitToLonLat(vec3\x20lonLatLev,\x20vec3\x20speed)\x20{\x0a\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLatLev);\x0a\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20float\x20w\x20=\x20speed.z;\x0a\x20\x20vec3\x20windVectorInLonLatLev\x20=\x20vec3(u,\x20v,\x20w);\x0a\x0a\x20\x20return\x20windVectorInLonLatLev;\x0a}\x0a\x0avec3\x20calculateSpeedByRungeKutta2(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages\x20for\x20detail\x0a\x20\x20const\x20float\x20h\x20=\x200.5f;\x0a\x0a\x20\x20vec3\x20y_n\x20=\x20lonLatLev;\x0a\x20\x20vec3\x20f_n\x20=\x20linearInterpolation(lonLatLev);\x0a\x20\x20vec3\x20midpoint\x20=\x20y_n\x20+\x200.5f\x20*\x20h\x20*\x20convertSpeedUnitToLonLat(y_n,\x20f_n)\x20*\x20speedScaleFactor;\x0a\x20\x20vec3\x20speed\x20=\x20h\x20*\x20linearInterpolation(midpoint)\x20*\x20speedScaleFactor;\x0a\x0a\x20\x20return\x20speed;\x0a}\x0a\x0avec2\x20getRange(vec2\x20range)\x20{\x0a\x20\x20float\x20x1\x20=\x200.0f\x20-\x20range.x;\x0a\x20\x20float\x20x2\x20=\x20range.y\x20-\x200.0f;\x0a\x20\x20if(x1\x20<\x200.0f\x20||\x20x2\x20<\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(abs(x1),\x20abs(x2));\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f,\x20abs(max(x1,\x20x2)));\x0a\x20\x20}\x0a}\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20vec3\x20percent\x20=\x20vec3(0.0f);\x0a\x20\x20vec2\x20uRange\x20=\x20getRange(uSpeedRange);\x0a\x20\x20vec2\x20vRange\x20=\x20getRange(vSpeedRange);\x0a\x20\x20vec2\x20wRange\x20=\x20getRange(wSpeedRange);\x0a\x20\x20if(length(speed.xyz)\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x200.0f;\x0a\x20\x20}\x0a\x0a\x20\x20percent.x\x20=\x20(abs(speed.x)\x20-\x20uRange.x)\x20/\x20(uRange.y\x20-\x20uRange.x);\x0a\x20\x20percent.y\x20=\x20(abs(speed.y)\x20-\x20vRange.x)\x20/\x20(vRange.y\x20-\x20vRange.x);\x0a\x20\x20if(wSpeedRange.y\x20==\x20wSpeedRange.x)\x20{\x0a\x20\x20\x20\x20percent.z\x20=\x200.0f;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20percent.z\x20=\x20(abs(speed.z)\x20-\x20wRange.x)\x20/\x20(wRange.y\x20-\x20wRange.x);\x0a\x20\x20}\x0a\x20\x20float\x20norm\x20=\x20length(percent);\x0a\x0a\x20\x20return\x20norm;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20vec3\x20speedOrigin\x20=\x20linearInterpolation(lonLatLev);\x0a\x20\x20vec3\x20speed\x20=\x20calculateSpeedByRungeKutta2(lonLatLev);\x0a\x20\x20vec3\x20speedInLonLat\x20=\x20convertSpeedUnitToLonLat(lonLatLev,\x20speed);\x0a\x0a\x20\x20vec4\x20particleSpeed\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speed\x20/\x20speedScaleFactor));\x0a\x20\x20\x20\x20//\x20gl_FragColor\x20=\x20particleSpeed;\x0a\x20\x20fragColor\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speedOrigin));\x0a}\x0a',PostProcessingPositionShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20norm)\x0a\x0auniform\x20sampler2D\x20H;\x20//\x20particles\x20height\x20textures\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0auniform\x20vec2\x20viewerLonRange;\x0auniform\x20vec2\x20viewerLatRange;\x0a\x0aconst\x20float\x20randomCoefficient\x20=\x200.1f;\x20//\x20use\x20to\x20improve\x20the\x20pseudo-random\x20generator\x0aconst\x20float\x20dropRate\x20=\x200.1f;\x20//\x20drop\x20rate\x20is\x20a\x20chance\x20a\x20particle\x20will\x20restart\x20at\x20random\x20position\x20to\x20avoid\x20degeneration\x0aconst\x20float\x20dropRateBump\x20=\x200.1f;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLatLev.x\x20=\x20clamp(lonLatLev.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20minimum.y,\x20maximum.y);\x0a\x20\x20lonLatLev.z\x20=\x20clamp(lonLatLev.z,\x20minimum.z,\x20maximum.z);\x0a\x0a\x20\x20vec3\x20index3D\x20=\x20vec3(0.0f);\x0a\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20index3D.z\x20=\x20ceil((lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z);\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0avec4\x20getTextureValue(sampler2D\x20componentTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20vec4\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D);\x0a\x20\x20return\x20result;\x0a}\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898f,\x2078.233f,\x204375.85453f);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0f,\x201.0f);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0abool\x20particleNoSpeed(vec3\x20particle)\x20{\x0a\x20\x20vec4\x20speed\x20=\x20getTextureValue(particlesSpeed,\x20particle);\x0a\x20\x20return\x20speed.r\x20==\x200.0f\x20&&\x20speed.g\x20==\x200.0f;\x0a}\x0a\x0avec3\x20generateRandomParticle(vec2\x20seed,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20longitude\x20is\x20in\x20[0,\x20360]\x0a\x20\x20float\x20randomLon\x20=\x20mod(rand(seed,\x20lonRange),\x20360.0f);\x0a\x20\x20float\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x0a\x20\x20float\x20height\x20=\x20getTextureValue(H,\x20vec3(randomLon,\x20randomLat,\x20lev)).r;\x0a\x0a\x20\x20return\x20vec3(randomLon,\x20randomLat,\x20height);\x0a}\x0a\x0abool\x20particleOutbound(vec3\x20particle)\x20{\x0a\x20\x20return\x20particle.y\x20<\x20viewerLatRange.x\x20||\x20particle.y\x20>\x20viewerLatRange.y\x20||\x20particle.x\x20<\x20viewerLonRange.x\x20||\x20particle.x\x20>\x20viewerLonRange.y;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec3\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20vec4\x20nextSpeed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20float\x20speedNorm\x20=\x20nextSpeed.a;\x0a\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20speedNorm;\x0a\x0a\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20seed2\x20=\x20nextSpeed.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec3\x20randomParticle\x20=\x20generateRandomParticle(seed1,\x20nextParticle.z);\x0a\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20if(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(randomParticle,\x201.0f);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f);\x0a\x20\x20}\x0a}\x0a';function _0x4e6006(_0x264de8,_0x4b4df1){return _0x492e(_0x264de8-0x3cd,_0x4b4df1);}var UpdatePositionShader=_0x448398(0x37d,0x315);const Cesium$3=mars3d__namespace['Cesium'];class ParticlesComputing{constructor(_0x4deac9,_0x3fb8a2,_0x1e57bc,_0x271438){function _0x34ba73(_0x2ff558,_0x34ae01){return _0x4e6006(_0x2ff558- -0x57d,_0x34ae01);}this['data']=_0x3fb8a2,this['createWindTextures'](_0x4deac9,_0x3fb8a2);function _0x1c25d1(_0x197936,_0xc7406e){return _0x4e6006(_0xc7406e- -0x22d,_0x197936);}this[_0x1c25d1(0x439,0x3be)](_0x4deac9,_0x1e57bc,_0x271438),this[_0x34ba73(0xa4,0xc4)](_0x3fb8a2,_0x1e57bc,_0x271438);}['createWindTextures'](_0x2715ab,_0x5942bf){function _0x2564b0(_0x1a4975,_0x5e507c){return _0x448398(_0x5e507c,_0x1a4975- -0x137);}var _0x502b34;function _0x408c0c(_0xc2e98a,_0x414dad){return _0x448398(_0x414dad,_0xc2e98a-0x297);}const _0x2d9048={'context':_0x2715ab,'width':_0x5942bf['dimensions'][_0x408c0c(0x57e,0x570)],'height':_0x5942bf['dimensions']['lat']*(_0x5942bf['dimensions'][_0x408c0c(0x616,0x625)]||0x1),'pixelFormat':Cesium$3['PixelFormat']['RED'],'pixelDatatype':Cesium$3[_0x2564b0(0x1a2,0x1ba)][_0x408c0c(0x61b,0x60d)],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3['TextureMinificationFilter']['NEAREST'],'magnificationFilter':Cesium$3['TextureMagnificationFilter']['NEAREST']})};this[_0x408c0c(0x53a,0x501)]={'U':Util['createTexture'](_0x2d9048,_0x5942bf['U'][_0x2564b0(0x19d,0x209)]),'V':Util['createTexture'](_0x2d9048,_0x5942bf['V'][_0x2564b0(0x19d,0x1a5)]),'W':Util[_0x2564b0(0x23b,0x1f0)](_0x2d9048,((_0x502b34=_0x5942bf['W'])===null||_0x502b34===void 0x0?void 0x0:_0x502b34['array'])??_0x5942bf['U'][_0x2564b0(0x19d,0x1c1)]),'H':Util['createTexture'](_0x2d9048,_0x5942bf['H'][_0x408c0c(0x56b,0x5f6)])};}[_0x4e6006(0x5eb,0x562)](_0x5baff5,_0x4fa1a9,_0x4adffb){const _0x3f02f3={'context':_0x5baff5,'width':_0x4fa1a9[_0x88bbbd(0x3cb,0x3f4)],'height':_0x4fa1a9['particlesTextureSize'],'pixelFormat':Cesium$3['PixelFormat']['RGBA'],'pixelDatatype':Cesium$3['PixelDatatype'][_0x88bbbd(0x518,0x504)],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3[_0x27d6b4(0x17c,0x1da)][_0x88bbbd(0x4ca,0x43d)],'magnificationFilter':Cesium$3['TextureMagnificationFilter']['NEAREST']})};function _0x27d6b4(_0x7aba62,_0x378c6c){return _0x448398(_0x7aba62,_0x378c6c- -0x19e);}const _0x805aa4=this['randomizeParticles'](_0x4fa1a9[_0x88bbbd(0x4f3,0x4d9)],_0x4adffb);function _0x88bbbd(_0x59d8fc,_0x145527){return _0x448398(_0x59d8fc,_0x145527-0x180);}const _0x3f1fcb=new Float32Array(0x4*_0x4fa1a9['maxParticles'])['fill'](0x0);this['particlesTextures']={'previousParticlesPosition':Util['createTexture'](_0x3f02f3,_0x805aa4),'currentParticlesPosition':Util['createTexture'](_0x3f02f3,_0x805aa4),'nextParticlesPosition':Util[_0x88bbbd(0x56a,0x4f2)](_0x3f02f3,_0x805aa4),'postProcessingPosition':Util['createTexture'](_0x3f02f3,_0x805aa4),'particlesSpeed':Util['createTexture'](_0x3f02f3,_0x3f1fcb)};}[_0x4e6006(0x606,0x593)](_0x4c6a9f,_0x3ff05){const _0x20a281=new Float32Array(0x4*_0x4c6a9f);for(let _0x387997=0x0;_0x387997<_0x4c6a9f;_0x387997++){_0x20a281[0x4*_0x387997]=Cesium$3[_0x581612(-0x133,-0xb6)]['randomBetween'](_0x3ff05['lonRange']['x'],_0x3ff05[_0x2c61e6(0x18a,0x12d)]['y']),_0x20a281[0x4*_0x387997+0x1]=Cesium$3[_0x581612(-0xa1,-0xb6)][_0x2c61e6(0x12f,0x18b)](_0x3ff05[_0x581612(-0xde,-0x81)]['x'],_0x3ff05[_0x581612(-0x12,-0x81)]['y']),_0x20a281[0x4*_0x387997+0x2]=Cesium$3[_0x2c61e6(0x11a,0x109)]['randomBetween'](this['data']['lev']['min'],this['data'][_0x2c61e6(0x24a,0x20f)]['max']),_0x20a281[0x4*_0x387997+0x3]=0x0;}function _0x581612(_0x4c164f,_0x1c40ea){return _0x4e6006(_0x1c40ea- -0x5cb,_0x4c164f);}function _0x2c61e6(_0x582575,_0x18254e){return _0x448398(_0x582575,_0x18254e- -0x170);}return _0x20a281;}[_0x448398(0x3d7,0x388)](_0x12bbf4){const _0x54bcf0=[_0x12bbf4['dimensions']['lon'],_0x12bbf4[_0x4c0f1c(0x29,0x8)]['lat'],_0x12bbf4['dimensions'][_0x26f152(0x40,0x47)]];function _0x4c0f1c(_0x1ba8a1,_0x3bcdd3){return _0x448398(_0x1ba8a1,_0x3bcdd3- -0x36f);}const _0x48e5f5=[_0x12bbf4[_0x26f152(-0x58,-0x70)][_0x26f152(-0x9e,-0x5b)],_0x12bbf4[_0x26f152(-0x3,0x34)][_0x26f152(-0x9e,-0xf7)],_0x12bbf4['lev']['min']],_0x444af5=[_0x12bbf4['lon']['max'],_0x12bbf4[_0x4c0f1c(-0x96,-0x33)][_0x26f152(-0xb1,-0xd3)],_0x12bbf4[_0x4c0f1c(0x65,0x10)]['max']],_0x505c51=[(_0x444af5[0x0]-_0x48e5f5[0x0])/(_0x54bcf0[0x0]-0x1),(_0x444af5[0x1]-_0x48e5f5[0x1])/(_0x54bcf0[0x1]-0x1),_0x54bcf0[0x2]>0x1?(_0x444af5[0x2]-_0x48e5f5[0x2])/(_0x54bcf0[0x2]-0x1):0x1],_0x21fa2c=Math[_0x4c0f1c(-0x114,-0xa1)](Math['random']()*_0x12bbf4['U']['array']['length']),_0x37c332=_0x21fa2c%(_0x54bcf0[0x0]*_0x54bcf0[0x1]),_0x1cdda9=Math[_0x4c0f1c(-0x87,-0xa1)](_0x37c332/_0x54bcf0[0x0]),_0x4eebc0=_0x37c332%_0x54bcf0[0x0],_0x56481f=Cesium$3['Math']['randomBetween'](_0x48e5f5[0x0]+_0x4eebc0*_0x505c51[0x0],_0x48e5f5[0x0]+(_0x4eebc0+0x1)*_0x505c51[0x0]);function _0x26f152(_0x41c022,_0xd3b939){return _0x448398(_0xd3b939,_0x41c022- -0x33f);}const _0xe2d37c=Cesium$3['Math']['randomBetween'](_0x48e5f5[0x1]+(_0x1cdda9-0x1)*_0x505c51[0x1],_0x48e5f5[0x1]+_0x1cdda9*_0x505c51[0x1]),_0x57682a=_0x12bbf4['H'][_0x4c0f1c(-0x10d,-0x9b)][_0x21fa2c]||0x0;return[_0x56481f,_0xe2d37c,_0x57682a];}['destroyParticlesTextures'](){function _0x5b4614(_0x321bf6,_0x110f1c){return _0x448398(_0x110f1c,_0x321bf6- -0x312);}function _0x2e2f42(_0x493d13,_0xa9f535){return _0x4e6006(_0x493d13- -0x74f,_0xa9f535);}Object[_0x5b4614(-0x66,-0x6a)](this['particlesTextures'])[_0x5b4614(-0x7c,-0xd0)](_0x16092e=>{this['particlesTextures'][_0x16092e]['destroy']();});}[_0x448398(0x331,0x385)](_0x12eeea,_0x4f47b0,_0x35bcda){const _0x1f28bf=new Cesium$3[(_0x409003(0x11c,0x13e))](_0x12eeea['dimensions'][_0x4dfc37(0x4da,0x48b)],_0x12eeea['dimensions']['lat'],_0x12eeea[_0x409003(0x192,0x1ed)]['lev']),_0x3560eb=new Cesium$3[(_0x4dfc37(0x4bb,0x51b))](_0x12eeea[_0x4dfc37(0x4da,0x461)]['min'],_0x12eeea[_0x409003(0x160,0x1b2)][_0x409003(0xb8,0x117)],_0x12eeea['lev'][_0x409003(0xd0,0x117)]),_0x39a2db=new Cesium$3['Cartesian3'](_0x12eeea['lon'][_0x4dfc37(0x481,0x4a2)],_0x12eeea[_0x4dfc37(0x52f,0x590)]['max'],_0x12eeea[_0x4dfc37(0x572,0x508)]['max']),_0x55c332=new Cesium$3['Cartesian3']((_0x39a2db['x']-_0x3560eb['x'])/(_0x1f28bf['x']-0x1),(_0x39a2db['y']-_0x3560eb['y'])/(_0x1f28bf['y']-0x1),_0x1f28bf['z']>0x1?(_0x39a2db['z']-_0x3560eb['z'])/(_0x1f28bf['z']-0x1):0x1),_0x439d21=new Cesium$3[(_0x4dfc37(0x4de,0x4ba))](_0x12eeea[_0x409003(0x181,0x15d)]['min'],_0x12eeea[_0x409003(0x157,0x15d)][_0x409003(0x189,0x104)]);function _0x409003(_0x2212b3,_0x4e4704){return _0x448398(_0x2212b3,_0x4e4704- -0x18a);}const _0x2e8ba=new Cesium$3['Cartesian2'](_0x12eeea['lat'][_0x4dfc37(0x494,0x43a)],_0x12eeea[_0x409003(0x1cd,0x1b2)]['max']),_0x1c7807=new Cesium$3[(_0x4dfc37(0x4de,0x503))](_0x12eeea['U'][_0x409003(0x9f,0x117)],_0x12eeea['U'][_0x4dfc37(0x481,0x4cb)]),_0xfedaf6=new Cesium$3[(_0x4dfc37(0x4de,0x531))](_0x12eeea['V'][_0x4dfc37(0x494,0x508)],_0x12eeea['V'][_0x409003(0xcb,0x104)]),_0x140739=new Cesium$3[(_0x409003(0x197,0x161))](_0x12eeea['W'][_0x4dfc37(0x494,0x429)],_0x12eeea['W']['max']),_0x18acd9=this,_0x50e52c={};_0x50e52c['U']=function(){return _0x18acd9['windTextures']['U'];},_0x50e52c['V']=function(){function _0x4b40b9(_0x5483fa,_0x945d50){return _0x4dfc37(_0x945d50- -0x69f,_0x5483fa);}return _0x18acd9[_0x4b40b9(-0x1b5,-0x209)]['V'];},_0x50e52c['W']=function(){return _0x18acd9['windTextures']['W'];},_0x50e52c[_0x4dfc37(0x477,0x3f6)]=function(){function _0x422472(_0xbed4ab,_0x2bcbc7){return _0x409003(_0x2bcbc7,_0xbed4ab- -0x350);}function _0x502eee(_0x1f5be6,_0x448088){return _0x4dfc37(_0x448088- -0x51a,_0x1f5be6);}return _0x18acd9[_0x502eee(-0x122,-0xa0)][_0x502eee(-0xc4,-0xa3)];},_0x50e52c['dimension']=function(){return _0x1f28bf;},_0x50e52c[_0x409003(0xc8,0x141)]=function(){return _0x3560eb;},_0x50e52c['maximum']=function(){return _0x39a2db;},_0x50e52c['interval']=function(){return _0x55c332;},_0x50e52c['uSpeedRange']=function(){return _0x1c7807;};function _0x4dfc37(_0x1695c5,_0x5336d3){return _0x4e6006(_0x1695c5- -0xa9,_0x5336d3);}_0x50e52c[_0x4dfc37(0x4c2,0x515)]=function(){return _0xfedaf6;},_0x50e52c[_0x409003(0x222,0x19a)]=function(){return _0x140739;},_0x50e52c[_0x409003(0xe0,0x16c)]=function(){function _0x6c56ab(_0x2ddfbc,_0x52339f){return _0x4dfc37(_0x52339f- -0x5e,_0x2ddfbc);}return _0x35bcda[_0x6c56ab(0x435,0x45e)]*_0x4f47b0['speedFactor'];};const _0x1a9ebf={};_0x1a9ebf[_0x4dfc37(0x47e,0x430)]=[CalculateSpeedShader];const _0x2f6d55={};_0x2f6d55['sources']=[UpdatePositionShader];const _0x17d549={};_0x17d549['sources']=[PostProcessingPositionShader],this[_0x409003(0x159,0xf8)]={'calculateSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':_0x50e52c,'fragmentShaderSource':new Cesium$3['ShaderSource'](_0x1a9ebf),'outputTexture':this[_0x4dfc37(0x47a,0x4ca)]['particlesSpeed'],'preExecute':function(){if(_0x4f47b0!==undefined&&_0x4f47b0['dynamic']){const _0x4eea6c=_0x18acd9[_0x243bc4(-0x200,-0x254)]['previousParticlesPosition'];_0x18acd9[_0x243bc4(-0x200,-0x28b)]['previousParticlesPosition']=_0x18acd9[_0x423fba(0x17d,0x157)]['currentParticlesPosition'],_0x18acd9[_0x243bc4(-0x200,-0x175)][_0x243bc4(-0x203,-0x285)]=_0x18acd9[_0x243bc4(-0x200,-0x274)]['postProcessingPosition'],_0x18acd9['particlesTextures']['postProcessingPosition']=_0x4eea6c;}function _0x243bc4(_0x2fb475,_0x1d1475){return _0x409003(_0x1d1475,_0x2fb475- -0x2fd);}function _0x423fba(_0x12f5a5,_0x4ea09f){return _0x4dfc37(_0x12f5a5- -0x2fd,_0x4ea09f);}_0x18acd9[_0x423fba(0x178,0x1d9)]['calculateSpeed']['commandToExecute']['outputTexture']=_0x18acd9['particlesTextures']['particlesSpeed'];}}),'updatePosition':new CustomPrimitive({'commandType':_0x409003(0x1ed,0x1f3),'uniformMap':{'currentParticlesPosition':function(){function _0x2b0959(_0x2f183f,_0x4c235b){return _0x4dfc37(_0x2f183f- -0x10b,_0x4c235b);}function _0x27ea44(_0x449176,_0x182c45){return _0x409003(_0x449176,_0x182c45-0xad);}return _0x18acd9[_0x2b0959(0x36f,0x32a)][_0x27ea44(0x1c6,0x1a7)];},'particlesSpeed':function(){return _0x18acd9['particlesTextures']['particlesSpeed'];}},'fragmentShaderSource':new Cesium$3[(_0x4dfc37(0x538,0x535))](_0x2f6d55),'outputTexture':this['particlesTextures']['nextParticlesPosition'],'preExecute':function(){function _0x3255be(_0x4973d6,_0x3394b6){return _0x4dfc37(_0x4973d6- -0x43b,_0x3394b6);}function _0x418cbc(_0x4ea4f3,_0x3f685f){return _0x409003(_0x3f685f,_0x4ea4f3- -0x25c);}_0x18acd9[_0x3255be(0x3a,0xa2)][_0x3255be(0x92,0xa8)]['commandToExecute'][_0x418cbc(-0x10b,-0x83)]=_0x18acd9['particlesTextures']['nextParticlesPosition'];}}),'postProcessingPosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'nextParticlesPosition':function(){function _0x5522e6(_0x159a40,_0x190e94){return _0x409003(_0x159a40,_0x190e94-0xa2);}function _0x367c0c(_0x3c4c21,_0x2c973b){return _0x4dfc37(_0x3c4c21- -0x4b7,_0x2c973b);}return _0x18acd9[_0x5522e6(0x22b,0x19f)][_0x5522e6(0x1c6,0x232)];},'particlesSpeed':function(){return _0x18acd9['particlesTextures']['particlesSpeed'];},'viewerLonRange':function(){return _0x35bcda['lonRange'];},'viewerLatRange':function(){return _0x35bcda['latRange'];},'lonRange':function(){return _0x439d21;},'latRange':function(){return _0x2e8ba;},'dimension':function(){return _0x1f28bf;},'minimum':function(){return _0x3560eb;},'maximum':function(){return _0x39a2db;},'interval':function(){return _0x55c332;},'H':function(){function _0x5a9a95(_0x2b795c,_0x37d786){return _0x4dfc37(_0x2b795c- -0x2b9,_0x37d786);}return _0x18acd9[_0x5a9a95(0x1dd,0x1ed)]['H'];},'randomCoefficient':function(){const _0x51e046=Math['random']();return _0x51e046;},'dropRate':function(){function _0x117970(_0x4c3a8a,_0x2ed7d2){return _0x4dfc37(_0x4c3a8a- -0x1ec,_0x2ed7d2);}return _0x4f47b0[_0x117970(0x2a7,0x283)];},'dropRateBump':function(){return _0x4f47b0['dropRateBump'];}},'fragmentShaderSource':new Cesium$3[(_0x409003(0x1a5,0x1bb))](_0x17d549),'outputTexture':this[_0x4dfc37(0x47a,0x446)][_0x409003(0x103,0xeb)],'preExecute':function(){function _0x120003(_0x337a04,_0x5ebf02){return _0x4dfc37(_0x5ebf02- -0x288,_0x337a04);}function _0x4581a8(_0x193969,_0x55577b){return _0x409003(_0x193969,_0x55577b-0x84);}_0x18acd9[_0x120003(0x23d,0x1ed)]['postProcessingPosition']['commandToExecute'][_0x120003(0x24e,0x246)]=_0x18acd9[_0x4581a8(0x1ee,0x181)]['postProcessingPosition'];}})};}}const Cesium$2=mars3d__namespace['Cesium'];class ParticleSystem{constructor(_0x681df1,_0x1e79fa,_0x5e6051,_0x3db039){this['context']=_0x681df1,_0x1e79fa={..._0x1e79fa};function _0x18273c(_0x406d62,_0x4fb6c6){return _0x448398(_0x406d62,_0x4fb6c6- -0x55);}_0x1e79fa[_0x18273c(0x22d,0x265)]&&_0x1e79fa['vdata']&&(_0x1e79fa['dimensions']={},_0x1e79fa['dimensions']['lon']=_0x1e79fa['cols'],_0x1e79fa[_0x18273c(0x39b,0x322)][_0x18273c(0x31c,0x2e7)]=_0x1e79fa['rows'],_0x1e79fa['dimensions']['lev']=_0x1e79fa['lev']||0x1,_0x1e79fa[_0x18273c(0x27e,0x292)]={},_0x1e79fa['lon'][_0x5ed0f1(-0xcd,-0x155)]=_0x1e79fa['xmin'],_0x1e79fa['lon']['max']=_0x1e79fa['xmax'],_0x1e79fa['lat']={},_0x1e79fa['lat'][_0x5ed0f1(-0xcd,-0xb4)]=_0x1e79fa[_0x5ed0f1(-0xef,-0x157)],_0x1e79fa['lat'][_0x18273c(0x280,0x239)]=_0x1e79fa['ymax'],_0x1e79fa['lev']={},_0x1e79fa['lev'][_0x5ed0f1(-0xcd,-0x107)]=_0x1e79fa[_0x18273c(0x1f9,0x252)]??0x1,_0x1e79fa[_0x5ed0f1(0x11,0x5a)][_0x18273c(0x224,0x239)]=_0x1e79fa['levmax']??0x1,_0x1e79fa['U']={},_0x1e79fa['U'][_0x18273c(0x226,0x27f)]=new Float32Array(_0x1e79fa[_0x18273c(0x224,0x265)]),_0x1e79fa['U']['min']=_0x1e79fa['umin']??Math['min'](..._0x1e79fa[_0x5ed0f1(-0xb4,-0xed)]),_0x1e79fa['U']['max']=_0x1e79fa['umax']??Math['max'](..._0x1e79fa['udata']),_0x1e79fa['V']={},_0x1e79fa['V']['array']=new Float32Array(_0x1e79fa[_0x18273c(0x29b,0x28f)]),_0x1e79fa['V']['min']=_0x1e79fa[_0x18273c(0x31c,0x2e2)]??Math[_0x5ed0f1(-0xcd,-0xb3)](..._0x1e79fa[_0x5ed0f1(-0x8a,-0x3f)]),_0x1e79fa['V'][_0x5ed0f1(-0xe0,-0xde)]=_0x1e79fa['vmax']??Math['max'](..._0x1e79fa['vdata']));function _0x5ed0f1(_0x4d306a,_0x236f59){return _0x4e6006(_0x4d306a- -0x60a,_0x236f59);}!_0x1e79fa['W']&&(_0x1e79fa['W']={'array':new Float32Array(_0x1e79fa['U'][_0x5ed0f1(-0x9a,-0x83)]['length']),'min':0x0,'max':0x0});if(!_0x1e79fa['H']){var _0x26addc;_0x1e79fa['H']={'array':new Float32Array(_0x1e79fa['U'][_0x5ed0f1(-0x9a,-0x114)][_0x5ed0f1(-0xcf,-0xda)]),'min':0x0,'max':0x0};if((_0x26addc=_0x1e79fa[_0x5ed0f1(0x11,-0x65)])!==null&&_0x26addc!==void 0x0&&_0x26addc['array']){const {lon:_0xba6c5c,lat:_0x58b6dc,lev:_0x30a85f}=_0x1e79fa['dimensions'];for(let _0x3a6099=0x0;_0x3a6099<_0x30a85f;_0x3a6099++){for(let _0x5131f9=0x0;_0x5131f9<_0x58b6dc;_0x5131f9++){for(let _0x568578=0x0;_0x568578<_0xba6c5c;_0x568578++){const _0x1e4ebd=_0x3a6099*(_0xba6c5c*_0x58b6dc)+_0x5131f9*_0xba6c5c+_0x568578;_0x1e79fa['H'][_0x5ed0f1(-0x9a,-0xa5)][_0x1e4ebd]=_0x1e79fa['lev']['array'][_0x3a6099];}}}_0x1e79fa['H'][_0x5ed0f1(-0xcd,-0x8d)]=Math['min'](..._0x1e79fa[_0x18273c(0x301,0x32a)]['array']),_0x1e79fa['H']['max']=Math[_0x18273c(0x1b1,0x239)](..._0x1e79fa[_0x5ed0f1(0x11,0x4b)]['array']);}}this['data']=_0x1e79fa,this[_0x18273c(0x2a4,0x306)]=_0x5e6051,this['viewerParameters']=_0x3db039,this[_0x18273c(0x267,0x23c)]=new ParticlesComputing(this['context'],this[_0x18273c(0x248,0x245)],this[_0x18273c(0x2da,0x306)],this['viewerParameters']),this['particlesRendering']=new ParticlesRendering(this['context'],this['data'],this['options'],this['viewerParameters'],this[_0x18273c(0x29d,0x23c)]);}['canvasResize'](_0x18d318){this['particlesComputing'][_0x170c10(0x45d,0x42a)]();function _0x1ae9f7(_0x5294fa,_0x2da743){return _0x448398(_0x5294fa,_0x2da743-0x14c);}function _0x170c10(_0x336257,_0x13928b){return _0x4e6006(_0x13928b- -0x15b,_0x336257);}Object['keys'](this[_0x170c10(0x382,0x3d2)]['windTextures'])['forEach'](_0x3d93da=>{function _0x230d2f(_0x587804,_0x1d968c){return _0x1ae9f7(_0x1d968c,_0x587804- -0x39c);}this['particlesComputing']['windTextures'][_0x3d93da][_0x230d2f(0xdb,0x13d)]();}),this[_0x170c10(0x422,0x3be)]['textures']['colorTable'][_0x1ae9f7(0x4dd,0x477)](),Object['keys'](this['particlesRendering'][_0x1ae9f7(0x46a,0x464)])['forEach'](_0x33c532=>{this['particlesRendering']['framebuffers'][_0x33c532]['destroy']();}),this['context']=_0x18d318,this['particlesComputing']=new ParticlesComputing(this['context'],this['data'],this['options'],this['viewerParameters']),this[_0x1ae9f7(0x42b,0x3c9)]=new ParticlesRendering(this[_0x1ae9f7(0x467,0x40a)],this[_0x170c10(0x350,0x3db)],this['options'],this['viewerParameters'],this['particlesComputing']);}['clearFramebuffers'](){function _0x18a601(_0x5e58b6,_0x359621){return _0x448398(_0x5e58b6,_0x359621- -0x13e);}function _0x254cd7(_0x1d9fdd,_0x562bc5){return _0x448398(_0x562bc5,_0x1d9fdd- -0x3);}const _0x43707d=new Cesium$2['ClearCommand']({'color':new Cesium$2['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Cesium$2['Pass']['OPAQUE']});Object['keys'](this['particlesRendering'][_0x254cd7(0x315,0x34c)])[_0x18a601(0x1a5,0x158)](_0x113f79=>{function _0x31baaa(_0x3b9d86,_0x7267d0){return _0x254cd7(_0x3b9d86- -0x4dc,_0x7267d0);}function _0x56dd9d(_0x284247,_0x27110c){return _0x18a601(_0x27110c,_0x284247- -0x124);}_0x43707d['framebuffer']=this['particlesRendering'][_0x56dd9d(0xb6,0xf5)][_0x113f79],_0x43707d[_0x31baaa(-0x1b0,-0x167)](this[_0x56dd9d(0x5c,0x7e)]);});}['refreshParticles'](_0x44421e,_0x4aaa55=!![]){function _0x877d2f(_0x1fe69d,_0x334d4a){return _0x448398(_0x1fe69d,_0x334d4a- -0x341);}_0x4aaa55&&(this[_0x22a576(-0x216,-0x24e)](),this['particlesComputing']['destroyParticlesTextures'](),this['particlesComputing']['createParticlesTextures'](this[_0x877d2f(-0x3f,-0x83)],this[_0x22a576(-0x1b5,-0x193)],this[_0x877d2f(-0x1f,0x16)]));function _0x22a576(_0xfd7719,_0x367ca7){return _0x4e6006(_0xfd7719- -0x7ac,_0x367ca7);}if(_0x44421e){var _0x559b72;const _0x50c4f5=this['particlesRendering']['createSegmentsGeometry'](this['options']);this['particlesRendering']['primitives'][_0x877d2f(-0xb7,-0x32)]['geometry']=_0x50c4f5;const _0x53a26b=Cesium$2['VertexArray']['fromGeometry']({'context':this[_0x22a576(-0x252,-0x240)],'geometry':_0x50c4f5,'attributeLocations':this['particlesRendering']['primitives'][_0x22a576(-0x201,-0x236)]['attributeLocations'],'bufferUsage':Cesium$2[_0x877d2f(0x90,0x30)][_0x22a576(-0x222,-0x1d9)]});(_0x559b72=this['particlesRendering']['primitives'])!==null&&_0x559b72!==void 0x0&&(_0x559b72=_0x559b72['segments'])!==null&&_0x559b72!==void 0x0&&_0x559b72['commandToExecute']&&(this['particlesRendering']['primitives'][_0x877d2f(-0x56,-0x32)]['commandToExecute'][_0x877d2f(-0x64,-0xc)]=_0x53a26b);}}['setOptions'](_0x4c7aa9){let _0x264b6f=![];this['options']['maxParticles']!==_0x4c7aa9['maxParticles']&&(_0x264b6f=!![]),Object['keys'](_0x4c7aa9)['forEach'](_0x180c77=>{this['options'][_0x180c77]=_0x4c7aa9[_0x180c77];}),this['refreshParticles'](_0x264b6f,_0x4c7aa9['dynamic']);}['applyViewerParameters'](_0xd99ceb){function _0x5d51bd(_0x104deb,_0x3be985){return _0x448398(_0x104deb,_0x3be985- -0x306);}Object['keys'](_0xd99ceb)[_0x297d7e(-0x109,-0x108)](_0x197932=>{this['viewerParameters'][_0x197932]=_0xd99ceb[_0x197932];});function _0x297d7e(_0x256d7b,_0x3c3a2b){return _0x4e6006(_0x3c3a2b- -0x63a,_0x256d7b);}this[_0x297d7e(-0x23,-0x25)](![]),!this[_0x5d51bd(0x5b,0x55)]['dynamic']&&(this['options'][_0x297d7e(-0xdd,-0x100)]=!![],this['setOptions'](this[_0x297d7e(-0xa3,-0x43)]),setTimeout(()=>{function _0x68a6ed(_0xcfd2e2,_0x44c1f9){return _0x5d51bd(_0x44c1f9,_0xcfd2e2-0x28b);}function _0x3b793f(_0x52b745,_0x4e244f){return _0x297d7e(_0x52b745,_0x4e244f-0x5f);}this[_0x68a6ed(0x2e0,0x26e)]['dynamic']=![],this[_0x3b793f(-0x22,0x15)](this[_0x3b793f(0x5f,0x1c)]);},0x1f4));}['destroy'](){function _0x4e2e93(_0x1a912e,_0xc18007){return _0x4e6006(_0xc18007- -0x3dd,_0x1a912e);}clearTimeout(this['canrefresh']),this['particlesComputing'][_0x4e2e93(0x22a,0x1a8)](),Object['keys'](this['particlesComputing']['windTextures'])['forEach'](_0x1258b1=>{function _0x439bb5(_0x551fd2,_0x57bf99){return _0x4e2e93(_0x551fd2,_0x57bf99-0x2d9);}function _0x342ee3(_0x35e6c1,_0x2b0757){return _0x4e2e93(_0x2b0757,_0x35e6c1- -0x2f3);}this[_0x439bb5(0x3e3,0x429)]['windTextures'][_0x1258b1][_0x439bb5(0x4a4,0x4c3)]();}),this['particlesRendering']['textures'][_0x47a051(0x6b,0xd4)]['destroy'](),Object[_0x4e2e93(0x1df,0x16b)](this['particlesRendering']['framebuffers'])[_0x4e2e93(0x183,0x155)](_0x21d3d0=>{function _0x5c6264(_0x4db62a,_0x3c4e39){return _0x47a051(_0x3c4e39-0x159,_0x4db62a);}this[_0x5c6264(0x173,0x12a)]['framebuffers'][_0x21d3d0]['destroy']();});function _0x47a051(_0x4b5fa1,_0x2e693c){return _0x448398(_0x2e693c,_0x4b5fa1- -0x2ac);}for(const _0x2b1634 in this){delete this[_0x2b1634];}}}const Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace[_0x448398(0x2bd,0x2e6)][_0x448398(0x36d,0x352)],_0x148f56={};function _0x14d6(){const _0x3ef792=['PixelFormat','_calcUV','STATIC_DRAW','_removedHook','add','commandList','4cLgbzc','depthTexture','fillRect','638358wTekVB','speedScaleFactor','xmin','ClearCommand','_updateIng2','clearFramebuffers','randomBetween','createRenderingFramebuffers','moveTo','particleSystem','willReadFrequently','toRadians','ellipsoid','_onMouseUpEvent','round','blending','type','postMessage','12bTRCBI','CanvasWindField','create','OPAQUE','show','position','_canrefresh','_speedRate','segments','reverseY','globalCompositeOperation','8668JPzwON','1194575KVMdPe','particleHeight','#version\x20300\x20es\x0a\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20norm)\x20Unit\x20converted\x20to\x20degrees\x20of\x20longitude\x20and\x20latitude\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20vec3\x20speed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x20\x20vec3\x20nextParticle\x20=\x20lonLatLev\x20+\x20speed;\x0a\x20\x20if(length(speed.rgb)\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(0.0f);\x0a\x20\x20}\x0a}\x0a','refreshTimer','colorTable','framebuffers','windData','nextParticlesPosition','ShaderProgram','speed','Geometry','none','EventType','container','_animateFrame','_maxAge','visibility','wSpeedRange','_addedHook','SCENE3D','_createCanvas','scene','uniformMap','RenderState','destroy','reverse','lineWidth','isInExtent','execute','getUVByXY','LayerUtil','age','nextTrails','_map','vertexArray','cols','vmin','DISABLE_LOG_DEPTH_FRAGMENT_WRITE','width','ComponentDatatype','_calc_speedRate','lat','canvasHeight','PointTrans','clientHeight','windField','isDestroy','depthTest','mouseHidden','mode','ShaderSource','254138zTnrkm','SceneMode','enabled','fromCache','_mountedHook','preRender','fragmentShaderSource','preExecute','attributeLocations','createParticlesTextures','_showHook','_data','BaseLayer','canvasWidth','setOptions','Draw','Color','viewerParameters','drawingBufferHeight','maxParticles','GeometryAttribute','options','#version\x20300\x20es\x0a\x0auniform\x20sampler2D\x20trailsColorTexture;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec4\x20trailsColor\x20=\x20texture(trailsColorTexture,\x20textureCoordinate);\x0a\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20if(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20trailsColor;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(0.0f);\x0a\x20\x20}\x0a}\x0a','mouse_move','toWindowCoordinates','ALWAYS','defines','currentTrails','defineProperty','updateViewerParameters','IDENTITY','all','frameRate','rows','addEventListener','_tomap','randomizeParticles','abs','PI_OVER_TWO','push','removeEventListener','clear','currentTrailsColor','BufferUsage','createTexture','7617231cdsjli','worker','pointer-events','height','dimensions','TextureMinificationFilter','refreshParticles','_setOptionsHook','getUVByPoint','clearCommand','Compute','grid','lev','rawRenderState','23690vWLlmk','absolute','LINEAR','FLOAT','createComputingPrimitives','commandToExecute','getSpeed','getValidRange','createSegmentsGeometry','update','unbindEvent','dropRateBump','particlesTextureSize','postProcessingPosition','EllipsoidalOccluder','ColorRamp','xmax','Math','RGB','UNSIGNED_INT','random','particlesRendering','off','ymin','mouseUp','fromDegrees','primitives','lng','currentParticlesPosition','segmentsDepth','__esModule','particlesTextures','_onMouseDownEvent','speedFactor','camera','sources','trails','pixelFormat','max','maxAge','PrimitiveType','particlesComputing','tlat','ymax','#version\x20300\x20es\x0a\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0auniform\x20sampler2D\x20segmentsColorTexture;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0auniform\x20sampler2D\x20currentTrailsColor;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0auniform\x20float\x20fadeOpacity;\x0a\x0aout\x20vec4\x20fragColor;\x0avoid\x20main()\x20{\x0a\x20\x20vec4\x20pointsColor\x20=\x20texture(segmentsColorTexture,\x20textureCoordinate);\x0a\x20\x20vec4\x20trailsColor\x20=\x20texture(currentTrailsColor,\x20textureCoordinate);\x0a\x20\x20trailsColor\x20=\x20floor(fadeOpacity\x20*\x20255.0f\x20*\x20trailsColor)\x20/\x20255.0f;\x20//\x20make\x20sure\x20the\x20trailsColor\x20will\x20be\x20strictly\x20decreased\x0a\x0a\x20\x20float\x20pointsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x20\x20fragColor\x20=\x20vec4(0.0f);\x0a\x20\x20if(pointsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20fragColor\x20+\x20pointsColor;\x0a\x20\x20}\x0a\x20\x20if(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20fragColor\x20+\x20trailsColor;\x0a\x20\x20}\x0a\x20\x20gl_FragDepth\x20=\x20min(pointsDepth,\x20trailsDepth);\x0a}\x0a','bind','forEach','createFramebuffer','getExtent','canvas','data','_onMapWhellEvent','createRawRenderState','lonRange','dynamic','length','dropRate','min','wheel','windTextures','_onMap_preRenderEvent','Pass','_bilinearInterpolation','levmin','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20st;\x0a//\x20it\x20is\x20not\x20normal\x20itself,\x20but\x20used\x20to\x20control\x20lines\x20drawing\x0ain\x20vec3\x20normal;\x20//\x20(point\x20to\x20use,\x20offset\x20sign,\x20not\x20used\x20component)\x0auniform\x20vec2\x20hRange;\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20vec2\x20wSpeedRange;\x0a\x0auniform\x20sampler2D\x20previousParticlesPosition;\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0auniform\x20float\x20particleHeight;\x0a\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20lineWidth;\x0a\x0astruct\x20adjacentPoints\x20{\x0a\x20\x20vec4\x20previous;\x0a\x20\x20vec4\x20current;\x0a\x20\x20vec4\x20next;\x0a};\x0a\x0aout\x20float\x20heightNormalization;\x0aout\x20float\x20speedNormalization;\x0avec3\x20convertCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20read\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20float\x20a\x20=\x206378137.0f;\x20//\x20Semi-major\x20axis\x0a\x20\x20float\x20b\x20=\x206356752.3142f;\x20//\x20Semi-minor\x20axis\x0a\x20\x20float\x20e2\x20=\x206.69437999014e-3f;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x20\x20float\x20longitude\x20=\x20radians(lonLatLev.x);\x0a\x0a\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0f\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20float\x20h\x20=\x20particleHeight\x20+\x20lonLatLev.z;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0f);\x0a\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calculateProjectedCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20the\x20range\x20of\x20longitude\x20in\x20Cesium\x20is\x20[-180,\x20180]\x20but\x20the\x20range\x20of\x20longitude\x20in\x20the\x20NetCDF\x20file\x20is\x20[0,\x20360]\x0a\x20\x20\x20\x20//\x20[0,\x20180]\x20is\x20corresponding\x20to\x20[0,\x20180]\x20and\x20[180,\x20360]\x20is\x20corresponding\x20to\x20[-180,\x200]\x0a\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x\x20+\x20180.0f,\x20360.0f)\x20-\x20180.0f;\x0a\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLatLev);\x0a\x20\x20vec4\x20projectedCoordinate\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0f);\x0a\x20\x20return\x20projectedCoordinate;\x0a}\x0a\x0avec4\x20calculateOffsetOnNormalDirection(vec4\x20pointA,\x20vec4\x20pointB,\x20float\x20offsetSign)\x20{\x0a\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0f);\x0a\x20\x20vec2\x20pointA_XY\x20=\x20(pointA.xy\x20/\x20pointA.w)\x20*\x20aspectVec2;\x0a\x20\x20vec2\x20pointB_XY\x20=\x20(pointB.xy\x20/\x20pointB.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20float\x20offsetLength\x20=\x20lineWidth\x20/\x202.0f;\x0a\x20\x20vec2\x20direction\x20=\x20normalize(pointB_XY\x20-\x20pointA_XY);\x0a\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0f,\x200.0f);\x0a\x20\x20return\x20offset;\x0a}\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20vec3\x20percent\x20=\x20vec3(0.0f);\x0a\x20\x20percent.x\x20=\x20(speed.x\x20-\x20uSpeedRange.x)\x20/\x20(uSpeedRange.y\x20-\x20uSpeedRange.x);\x0a\x20\x20percent.y\x20=\x20(speed.y\x20-\x20vSpeedRange.x)\x20/\x20(vSpeedRange.y\x20-\x20vSpeedRange.x);\x0a\x20\x20if(wSpeedRange.y\x20==\x20wSpeedRange.x)\x20{\x0a\x20\x20\x20\x20percent.z\x20=\x200.0f;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20percent.z\x20=\x20(speed.z\x20-\x20wSpeedRange.x)\x20/\x20(wSpeedRange.y\x20-\x20wSpeedRange.x);\x0a\x20\x20}\x0a\x20\x20float\x20norm\x20=\x20length(percent);\x0a\x0a\x20\x20return\x20norm;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec2\x20particleIndex\x20=\x20st;\x0a\x0a\x20\x20vec3\x20previousPosition\x20=\x20texture(previousParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20vec3\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20vec3\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex).rgb;\x0a\x0a\x20\x20float\x20isAnyRandomPointUsed\x20=\x20texture(postProcessingPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(currentParticlesPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(previousParticlesPosition,\x20particleIndex).a;\x0a\x0a\x20\x20adjacentPoints\x20projectedCoordinates;\x0a\x20\x20if(isAnyRandomPointUsed\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20projectedCoordinates.previous;\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20projectedCoordinates.previous;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20calculateProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20calculateProjectedCoordinate(nextPosition);\x0a\x20\x20}\x0a\x0a\x20\x20int\x20pointToUse\x20=\x20int(normal.x);\x0a\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x20\x20vec4\x20offset\x20=\x20vec4(0.0f);\x0a\x20\x20\x20\x20//\x20render\x20lines\x20with\x20triangles\x20and\x20miter\x20joint\x0a\x20\x20\x20\x20//\x20read\x20https://blog.scottlogic.com/2019/11/18/drawing-lines-with-webgl.html\x20for\x20detail\x0a\x20\x20if(pointToUse\x20==\x20-1)\x20{\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.previous,\x20projectedCoordinates.current,\x20offsetSign);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.previous\x20+\x20offset;\x0a\x20\x20}\x20else\x20if(pointToUse\x20==\x201)\x20{\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.current,\x20projectedCoordinates.next,\x20offsetSign);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.next\x20+\x20offset;\x0a\x20\x20}\x0a\x0a\x20\x20heightNormalization\x20=\x20(currentPosition.z\x20-\x20hRange.x)\x20/\x20(hRange.y\x20-\x20hRange.x);\x0a\x0a\x20\x20speedNormalization\x20=\x20texture(particlesSpeed,\x20particleIndex).a;\x0a}\x0a','particlesNumber','speedRate','2266566iNENJh','keys','viewport','latRange','RGBA','isPointVisible','green','framebuffer','_pointerEvents','clientWidth','mouseMove','getOptions','0px','TextureMagnificationFilter','VertexArray','udata','mouseDown','8DAybFG','NEAREST','context','style','mouse_down','resize','zIndex','get','vertexShaderSource','BoundingSphere','once','owner','Cartesian3','pixelSize','getFullscreenQuad','minimum','colors','_updateIng','floor','vSpeedRange','Cesium','WindUtil','createRenderingPrimitives','toDegrees','array','addPrimitives','DISABLE_GL_POSITION_LOG_DEPTH','particles','getParticles','PixelDatatype','updatePosition','outputTexture','fixedHeight','fadeOpacity','pow','register','frameTime','canvasContext','_onMouseMoveEvent','now','vdata','textures','layer','lon','redraw','destroyParticlesTextures','3921953KLINol','Cartesian2'];_0x14d6=function(){return _0x3ef792;};return _0x14d6();}_0x148f56['particlesNumber']=0x1000,_0x148f56['fixedHeight']=0x0,_0x148f56['fadeOpacity']=0.996,_0x148f56[_0x448398(0x2f6,0x2a0)]=0.003,_0x148f56[_0x4e6006(0x50f,0x4ad)]=0.01,_0x148f56[_0x448398(0x278,0x289)]=0.5,_0x148f56[_0x4e6006(0x5c9,0x601)]=0x2,_0x148f56[_0x448398(0x355,0x2cc)]=['rgb(206,255,255)'],_0x148f56[_0x448398(0x285,0x29e)]=!![];const DEF_OPTIONS=_0x148f56;class WindLayer extends BaseLayer$1{constructor(_0x420c48={}){_0x420c48={...DEF_OPTIONS,..._0x420c48},super(_0x420c48),this['_setOptionsHook'](_0x420c48);}get[_0x4e6006(0x582,0x542)](){return this['primitives'];}get['data'](){return this['_data'];}set[_0x4e6006(0x536,0x5a0)](_0x1b8eeb){this['setData'](_0x1b8eeb);}get['colors'](){return this['options']['colors'];}set['colors'](_0xd73ab2){this['options'][_0x43c6f4(-0x200,-0x1b3)]=_0xd73ab2;function _0x43c6f4(_0x33493c,_0xbc02b0){return _0x448398(_0x33493c,_0xbc02b0- -0x47f);}if(this['particleSystem']){const _0x3a945d={};_0x3a945d['colors']=_0xd73ab2,this['particleSystem']['setOptions'](_0x3a945d);}this['resize']();}[_0x4e6006(0x5e6,0x5eb)](){}['_addedHook'](){this['scene']=this['_map']['scene'],this[_0x1b48bc(0x1cb,0x1af)]=this[_0x1b48bc(0x275,0x214)][_0x1b48bc(0x1cb,0x1e1)];function _0x1b48bc(_0xdcfa91,_0x51760f){return _0x4e6006(_0xdcfa91- -0x35b,_0x51760f);}this[_0x501828(0x276,0x2ac)]=new Cesium$1['PrimitiveCollection'](),this[_0x1b48bc(0x275,0x20a)]['scene']['primitives']['add'](this['primitives']),this['viewerParameters']={'lonRange':new Cesium$1['Cartesian2'](),'latRange':new Cesium$1[(_0x1b48bc(0x22c,0x1a9))](),'pixelSize':0x0,'lonDisplayRange':new Cesium$1['Cartesian2'](),'latDisplayRange':new Cesium$1[(_0x501828(0x2df,0x2dd))]()},this['globeBoundingSphere']=new Cesium$1[(_0x1b48bc(0x206,0x235))](Cesium$1[_0x501828(0x2bc,0x306)]['ZERO'],0.99*0x615299),this['updateViewerParameters'](),window[_0x1b48bc(0x2a9,0x226)]('resize',this[_0x501828(0x2b5,0x22d)]['bind'](this),![]),this[_0x501828(0x2b4,0x2e6)]=![],this['mouse_move']=![];function _0x501828(_0x3816cf,_0x25136c){return _0x4e6006(_0x3816cf- -0x2a8,_0x25136c);}this['_map']['on'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace[_0x1b48bc(0x260,0x29f)][_0x501828(0x2af,0x329)],this[_0x1b48bc(0x1c9,0x1b1)],this),this['_map']['on'](mars3d__namespace['EventType']['mouseUp'],this['_onMouseUpEvent'],this),this[_0x501828(0x328,0x302)]['on'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this),this['_data']&&this['setData'](this[_0x501828(0x345,0x332)]);}['_removedHook'](){function _0x3c1a1c(_0x54f6a0,_0x3b5b07){return _0x448398(_0x3b5b07,_0x54f6a0- -0x286);}window[_0x3c1a1c(0xe8,0xcd)](_0x3c1a1c(0x3b,0x39),this['resize']),this['_map']['off'](mars3d__namespace['EventType']['preRender'],this['_onMap_preRenderEvent'],this);function _0x870316(_0x536d51,_0x4659ac){return _0x4e6006(_0x536d51- -0x33,_0x4659ac);}this['_map']['off'](mars3d__namespace['EventType'][_0x870316(0x50b,0x557)],this['_onMapWhellEvent'],this),this['_map'][_0x870316(0x4e7,0x509)](mars3d__namespace[_0x870316(0x588,0x503)][_0x3c1a1c(0x35,-0x38)],this['_onMouseDownEvent'],this),this['_map']['off'](mars3d__namespace['EventType']['mouseUp'],this['_onMouseUpEvent'],this),this['_map']['off'](mars3d__namespace[_0x870316(0x588,0x5a8)]['mouseMove'],this[_0x3c1a1c(0x5c,0x87)],this),this[_0x870316(0x4eb,0x4ba)]['removeAll'](),this['_map'][_0x3c1a1c(0xa2,0x108)]['primitives']['remove'](this['primitives']);}['resize'](){function _0x44dc5d(_0x5f3770,_0xe9848){return _0x448398(_0xe9848,_0x5f3770-0x22e);}if(!this['show']||!this['particleSystem'])return;this['primitives']['show']=![];function _0x369e1f(_0x374769,_0x2d22ff){return _0x4e6006(_0x2d22ff- -0x44e,_0x374769);}this['primitives']['removeAll'](),this[_0x44dc5d(0x562,0x4f6)][_0x44dc5d(0x4f4,0x4ee)](mars3d__namespace[_0x44dc5d(0x54d,0x4d6)][_0x44dc5d(0x579,0x55e)],this[_0x44dc5d(0x4d2,0x471)],this);}['_onMap_preRenderEvent'](_0x594744){this[_0x5ed0aa(-0x107,-0xac)]['canvasResize'](this[_0x5ed0aa(-0xd2,-0x82)]['context']);function _0x2f428e(_0x4a61a6,_0x4ec495){return _0x4e6006(_0x4ec495- -0x137,_0x4a61a6);}function _0x5ed0aa(_0x120279,_0x3b2e4b){return _0x448398(_0x120279,_0x3b2e4b- -0x3aa);}this['addPrimitives'](),this['primitives']['show']=!![];}[_0x4e6006(0x537,0x4b1)](_0x389626){clearTimeout(this['refreshTimer']);if(!this['show']||!this['particleSystem'])return;function _0x52fd73(_0x37f8fc,_0x45c10c){return _0x4e6006(_0x37f8fc- -0x675,_0x45c10c);}this[_0x2417b6(-0x16d,-0x15a)][_0x2417b6(-0xa0,-0xd1)]=![];function _0x2417b6(_0x892ce,_0x34a880){return _0x4e6006(_0x34a880- -0x678,_0x892ce);}this['refreshTimer']=setTimeout(()=>{function _0x5dbeae(_0x33a6c0,_0x172d21){return _0x52fd73(_0x172d21-0x3cf,_0x33a6c0);}if(!this['show'])return;this[_0x5dbeae(0x2a6,0x2de)]();},0xc8);}['_onMouseDownEvent'](_0x1336b9){this['mouse_down']=!![];}[_0x448398(0x369,0x2e2)](_0x2c4260){function _0x3fb6ed(_0x23a938,_0x25d7a1){return _0x4e6006(_0x25d7a1- -0x1f5,_0x23a938);}function _0x36611a(_0x9894d9,_0x2275b0){return _0x448398(_0x2275b0,_0x9894d9- -0xed);}if(!this[_0x36611a(0x21e,0x1ba)]||!this[_0x36611a(0x211,0x1ac)])return;this[_0x36611a(0x1d3,0x168)]&&(this['primitives']['show']=![],this[_0x3fb6ed(0x48a,0x404)]=!![]);}['_onMouseUpEvent'](_0x3a20e9){if(!this[_0xb47f42(0xd5,0xcb)]||!this[_0xb47f42(0xf5,0xbe)])return;function _0x4800a2(_0x5486e8,_0x1c50cf){return _0x4e6006(_0x1c50cf- -0x27b,_0x5486e8);}this['mouse_down']&&this['mouse_move']&&this['redraw']();this['primitives'][_0x4800a2(0x2cc,0x32c)]=!![];function _0xb47f42(_0x38a423,_0x553937){return _0x448398(_0x38a423,_0x553937- -0x240);}this['mouse_down']=![],this[_0xb47f42(0x91,0x11d)]=![];}['redraw'](){if(!this[_0xbcde7b(-0x40,0x9)]||!this[_0xbcde7b(0x3c,-0x20)])return;this['updateViewerParameters']();function _0xbcde7b(_0x532d1e,_0xd06009){return _0x448398(_0x532d1e,_0xd06009- -0x32b);}function _0x3d5860(_0x5147f7,_0x5e9ca1){return _0x448398(_0x5147f7,_0x5e9ca1-0x17b);}this['particleSystem']['applyViewerParameters'](this['viewerParameters']),this['primitives']['show']=!![];}['setData'](_0x5cf872){this['_data']=_0x5cf872;this[_0x48d8f0(-0x1ca,-0x1ca)]&&this['particleSystem'][_0x48d8f0(-0x19d,-0x1bd)]();function _0x57b311(_0x56b3c5,_0x128232){return _0x448398(_0x128232,_0x56b3c5- -0x180);}this[_0x57b311(0x17e,0x124)]=new ParticleSystem(this['scene']['context'],_0x5cf872,this['getOptions'](),this['viewerParameters']);function _0x48d8f0(_0x9e56f,_0x2298c8){return _0x448398(_0x2298c8,_0x9e56f- -0x4c8);}this[_0x48d8f0(-0x1f3,-0x1bd)]();}['_setOptionsHook'](_0x24490c,_0x29b667){function _0xecc1ec(_0x122c43,_0x4e8e95){return _0x448398(_0x4e8e95,_0x122c43-0x176);}if(_0x24490c)for(const _0x747379 in _0x24490c){this[_0x747379]=_0x24490c[_0x747379];}this['particleSystem']&&this['particleSystem']['setOptions'](this[_0xecc1ec(0x42c,0x45b)]());}['getOptions'](){const _0x2158aa=Math['ceil'](Math['sqrt'](this[_0x348684(0x2bd,0x325)]));this['particlesNumber']=_0x2158aa*_0x2158aa;const _0x35aed2={};_0x35aed2['particlesTextureSize']=_0x2158aa,_0x35aed2['maxParticles']=this[_0x348684(0x2bd,0x321)];function _0x496d2c(_0x349707,_0x265bda){return _0x4e6006(_0x349707- -0x261,_0x265bda);}_0x35aed2[_0x496d2c(0x307,0x304)]=this[_0x348684(0x2e0,0x2ee)],_0x35aed2[_0x496d2c(0x34f,0x3ab)]=this[_0x496d2c(0x317,0x2b9)];function _0x348684(_0x42776d,_0x2c3381){return _0x448398(_0x2c3381,_0x42776d-0x14);}return _0x35aed2[_0x496d2c(0x318,0x320)]=this[_0x496d2c(0x318,0x302)],_0x35aed2[_0x348684(0x2b4,0x310)]=this['dropRate'],_0x35aed2['dropRateBump']=this[_0x348684(0x287,0x2ac)],_0x35aed2['speedFactor']=this['speedFactor'],_0x35aed2['lineWidth']=this['lineWidth'],_0x35aed2['dynamic']=this['dynamic'],_0x35aed2;}[_0x448398(0x346,0x2d5)](){this['primitives']['add'](this['particleSystem'][_0x3251d8(0x7f,0x67)][_0x3251d8(0x70,0x71)]['calculateSpeed']),this[_0x3251d8(0x70,0x35)]['add'](this[_0x3251d8(0xec,0x73)]['particlesComputing']['primitives'][_0x18bcc4(0x26f,0x2bc)]);function _0x18bcc4(_0x102476,_0x5e7338){return _0x4e6006(_0x102476- -0x307,_0x5e7338);}this[_0x18bcc4(0x217,0x19c)][_0x3251d8(0xde,0xd3)](this[_0x18bcc4(0x293,0x2be)]['particlesComputing']['primitives'][_0x3251d8(0x63,-0x16)]),this['primitives']['add'](this[_0x3251d8(0xec,0x159)][_0x3251d8(0x6b,0xec)]['primitives']['segments']),this['primitives'][_0x18bcc4(0x285,0x26f)](this['particleSystem'][_0x3251d8(0x6b,-0xf)]['primitives']['trails']);function _0x3251d8(_0x369a39,_0x4799ed){return _0x448398(_0x4799ed,_0x369a39- -0x212);}this['primitives']['add'](this['particleSystem']['particlesRendering'][_0x3251d8(0x70,0xfc)]['screen']);}[_0x448398(0x3ab,0x363)](){let _0x35e941=this['camera']['computeViewRectangle'](this['scene']['globe'][_0x1a6557(-0x14f,-0x1b9)]);if(!_0x35e941){const _0x213223=this[_0x40c27c(0x463,0x4b8)][_0x40c27c(0x430,0x41c)]();_0x35e941=Cesium$1['Rectangle'][_0x40c27c(0x3bf,0x405)](_0x213223['xmin'],_0x213223['ymin'],_0x213223[_0x40c27c(0x397,0x3fc)],_0x213223[_0x40c27c(0x459,0x417)]);}const _0x142714=Util['viewRectangleToLonLatRange'](_0x35e941);this['_data']?(this[_0x40c27c(0x507,0x4db)][_0x1a6557(-0x1b3,-0x16e)]['x']=Math['max'](_0x142714['lon']['min'],this[_0x1a6557(-0xff,-0xdb)][_0x1a6557(-0x159,-0x1d2)]),this['viewerParameters'][_0x1a6557(-0x1b3,-0x236)]['y']=Math[_0x40c27c(0x3c5,0x425)](_0x142714['lon'][_0x1a6557(-0x1c2,-0x176)],this[_0x1a6557(-0xff,-0xcb)][_0x40c27c(0x409,0x3fc)]),this['viewerParameters'][_0x40c27c(0x3ef,0x432)]['x']=Math['max'](_0x142714['lat']['min'],this[_0x1a6557(-0xff,-0x153)]['ymin']),this['viewerParameters']['latRange']['y']=Math[_0x1a6557(-0x1af,-0x20a)](_0x142714[_0x1a6557(-0x114,-0x12d)]['max'],this[_0x40c27c(0x51e,0x4d5)]['ymax'])):(this['viewerParameters']['lonRange']['x']=_0x142714['lon']['min'],this[_0x40c27c(0x51f,0x4db)][_0x40c27c(0x403,0x421)]['y']=_0x142714['lon']['max'],this[_0x40c27c(0x51e,0x4db)]['latRange']['x']=_0x142714['lat']['min'],this[_0x1a6557(-0xf9,-0xb1)]['latRange']['y']=_0x142714['lat'][_0x40c27c(0x426,0x412)]);function _0x1a6557(_0x1bcb2f,_0x3ea830){return _0x4e6006(_0x1bcb2f- -0x6ec,_0x3ea830);}function _0x40c27c(_0xfd378b,_0x2beb5c){return _0x4e6006(_0x2beb5c- -0x118,_0xfd378b);}const _0x31ad4f=this[_0x40c27c(0x48d,0x40e)]['getPixelSize'](this['globeBoundingSphere'],this[_0x1a6557(-0x128,-0xd4)]['drawingBufferWidth'],this['scene']['drawingBufferHeight']);_0x31ad4f>0x0&&(this['viewerParameters'][_0x40c27c(0x48d,0x44d)]=_0x31ad4f);}}mars3d__namespace[_0x448398(0x2ff,0x331)]['register']('wind',WindLayer),mars3d__namespace['layer']['WindLayer']=WindLayer;class CanvasParticle{constructor(){function _0x59198e(_0x166d47,_0x49cb52){return _0x4e6006(_0x49cb52- -0x369,_0x166d47);}function _0x733ff(_0x18be77,_0x473c3f){return _0x448398(_0x18be77,_0x473c3f- -0x1be);}this[_0x59198e(0x163,0x1b6)]=null,this[_0x59198e(0x251,0x26f)]=null,this['tlng']=null,this['tlat']=null,this[_0x733ff(0x122,0x174)]=null,this['speed']=null;}['destroy'](){for(const _0x37b725 in this){delete this[_0x37b725];}}}class CanvasWindField{constructor(_0x55a7f5){function _0x2b3e61(_0xad5584,_0xc94e60){return _0x4e6006(_0xc94e60- -0x769,_0xad5584);}this[_0x2b3e61(-0x16d,-0x179)](_0x55a7f5);}get[_0x448398(0x295,0x2aa)](){return this['_speedRate'];}set['speedRate'](_0x177f84){this['_speedRate']=(0x64-(_0x177f84>0x63?0x63:_0x177f84))*0x64;function _0x1c582b(_0x30a90b,_0x22f739){return _0x4e6006(_0x30a90b- -0x71c,_0x22f739);}function _0x16df50(_0x4f7907,_0x218bd6){return _0x4e6006(_0x218bd6- -0x64a,_0x4f7907);}this[_0x1c582b(-0x145,-0x141)]=[(this[_0x16df50(-0x19a,-0x136)]-this['xmin'])/this[_0x16df50(-0xd3,-0xa0)],(this['ymax']-this[_0x16df50(-0xe4,-0x12f)])/this[_0x16df50(-0x99,-0xa0)]];}get['maxAge'](){function _0x5c272f(_0x3c7338,_0x11e4d0){return _0x448398(_0x11e4d0,_0x3c7338- -0x2a7);}return this[_0x5c272f(0x7b,0xe1)];}set['maxAge'](_0x184ca7){function _0x5b6a8c(_0x410467,_0x3db1b7){return _0x448398(_0x3db1b7,_0x410467-0x175);}this[_0x5b6a8c(0x497,0x445)]=_0x184ca7;}['setOptions'](_0x2708dd){function _0xd730f(_0x11df3f,_0x361819){return _0x4e6006(_0x11df3f- -0x273,_0x361819);}this['options']=_0x2708dd,this[_0x16fd46(-0x9e,-0xb1)]=_0x2708dd['maxAge']||0x78,this['speedRate']=_0x2708dd['speedRate']||0x32;function _0x16fd46(_0x45bc81,_0x4bb115){return _0x4e6006(_0x4bb115- -0x5dc,_0x45bc81);}this['particles']=[];const _0x4cde7d=_0x2708dd[_0x16fd46(-0x2e,-0x97)]||0x1000;for(let _0x3f5e2f=0x0;_0x3f5e2f<_0x4cde7d;_0x3f5e2f++){const _0x19eab9=this['_randomParticle'](new CanvasParticle());this[_0x16fd46(-0x72,-0x69)][_0xd730f(0x396,0x3f4)](_0x19eab9);}}['setDate'](_0x5a3dac){this[_0x4d908b(0x612,0x61b)]=_0x5a3dac['rows'];function _0x4d908b(_0x1e4fe7,_0x31698d){return _0x448398(_0x31698d,_0x1e4fe7-0x2ab);}this[_0x405bbc(-0x218,-0x1d0)]=_0x5a3dac[_0x4d908b(0x5e1,0x563)],this['xmin']=_0x5a3dac[_0x4d908b(0x5a2,0x585)],this['xmax']=_0x5a3dac[_0x405bbc(-0x201,-0x28e)],this['ymin']=_0x5a3dac[_0x405bbc(-0x203,-0x287)],this['ymax']=_0x5a3dac[_0x405bbc(-0x2cc,-0x273)],this[_0x405bbc(-0x191,-0x188)]=[];const _0x28b827=_0x5a3dac['udata'],_0x5046cc=_0x5a3dac['vdata'];let _0x52e613=![];_0x28b827[_0x405bbc(-0x2cb,-0x267)]===this['rows']&&_0x28b827[0x0]['length']===this[_0x405bbc(-0x1b7,-0x1d0)]&&(_0x52e613=!![]);let _0x2b48fa=0x0;function _0x405bbc(_0x24f11c,_0x40a4d3){return _0x4e6006(_0x40a4d3- -0x7a2,_0x24f11c);}let _0x41347d=null,_0x3bb516=null;for(let _0xa18813=0x0;_0xa18813<this['rows'];_0xa18813++){_0x41347d=[];for(let _0x3cf575=0x0;_0x3cf575<this['cols'];_0x3cf575++,_0x2b48fa++){_0x52e613?_0x3bb516=this['_calcUV'](_0x28b827[_0xa18813][_0x3cf575],_0x5046cc[_0xa18813][_0x3cf575]):_0x3bb516=this['_calcUV'](_0x28b827[_0x2b48fa],_0x5046cc[_0x2b48fa]),_0x41347d[_0x4d908b(0x618,0x5ec)](_0x3bb516);}this[_0x405bbc(-0x114,-0x188)][_0x4d908b(0x618,0x609)](_0x41347d);}this['options'][_0x4d908b(0x5bb,0x643)]&&this[_0x4d908b(0x629,0x5eb)][_0x405bbc(-0x17c,-0x1da)]();}['clear'](){delete this['rows'];function _0x2037e4(_0x3a2c0a,_0x236c1a){return _0x448398(_0x3a2c0a,_0x236c1a- -0x3d3);}delete this['cols'],delete this['xmin'],delete this['xmax'],delete this[_0x2037e4(-0x135,-0x154)],delete this[_0x2037e4(-0x18a,-0x140)],delete this['grid'];function _0xc85695(_0x493934,_0x4c8773){return _0x4e6006(_0x4c8773- -0x595,_0x493934);}delete this['particles'];}['toGridXY'](_0x2789b1,_0xff0156){const _0x14aecb=(_0x2789b1-this[_0x193609(0x4d3,0x46f)])/(this[_0x193609(0x454,0x437)]-this['xmin'])*(this['cols']-0x1),_0x134812=(this[_0xefb50a(0x17d,0x1b8)]-_0xff0156)/(this['ymax']-this['ymin'])*(this['rows']-0x1);function _0x193609(_0x510e5f,_0x35c86f){return _0x4e6006(_0x510e5f- -0xc0,_0x35c86f);}function _0xefb50a(_0x2559a0,_0x51d7e2){return _0x4e6006(_0x2559a0- -0x3b2,_0x51d7e2);}return[_0x14aecb,_0x134812];}[_0x4e6006(0x5cc,0x5b2)](_0x44732f,_0x4448e9){if(_0x44732f<0x0||_0x44732f>=this[_0x3be3a3(0x88,0x6f)]||_0x4448e9>=this['rows'])return[0x0,0x0,0x0];const _0x2de925=Math['floor'](_0x44732f);function _0x542a87(_0x34a67e,_0x329249){return _0x4e6006(_0x329249- -0x245,_0x34a67e);}const _0x2208ce=Math['floor'](_0x4448e9);if(_0x2de925===_0x44732f&&_0x2208ce===_0x4448e9)return this['grid'][_0x4448e9][_0x44732f];const _0x265f10=_0x2de925+0x1,_0x48e343=_0x2208ce+0x1,_0xb6c21f=this['getUVByXY'](_0x2de925,_0x2208ce),_0x26dd2a=this[_0x542a87(0x3c7,0x387)](_0x265f10,_0x2208ce);function _0x3be3a3(_0x432bdf,_0x5519de){return _0x448398(_0x432bdf,_0x5519de- -0x2c7);}const _0x1cdc08=this['getUVByXY'](_0x2de925,_0x48e343),_0xbb2586=this['getUVByXY'](_0x265f10,_0x48e343);let _0xda5bab=null;try{_0xda5bab=this['_bilinearInterpolation'](_0x44732f-_0x2de925,_0x4448e9-_0x2208ce,_0xb6c21f,_0x26dd2a,_0x1cdc08,_0xbb2586);}catch(_0x4f28d0){console['log'](_0x44732f,_0x4448e9);}return _0xda5bab;}[_0x4e6006(0x542,0x4ed)](_0x24e48c,_0x16d6b0,_0x3fc31b,_0x166fd1,_0x1d1d81,_0x11c440){const _0x297f71=0x1-_0x24e48c,_0x5041ab=0x1-_0x16d6b0,_0x30a584=_0x297f71*_0x5041ab,_0x1da261=_0x24e48c*_0x5041ab,_0x28fd98=_0x297f71*_0x16d6b0,_0x4acbad=_0x24e48c*_0x16d6b0,_0x4a33a1=_0x3fc31b[0x0]*_0x30a584+_0x166fd1[0x0]*_0x1da261+_0x1d1d81[0x0]*_0x28fd98+_0x11c440[0x0]*_0x4acbad,_0x3d9fa9=_0x3fc31b[0x1]*_0x30a584+_0x166fd1[0x1]*_0x1da261+_0x1d1d81[0x1]*_0x28fd98+_0x11c440[0x1]*_0x4acbad;return this['_calcUV'](_0x4a33a1,_0x3d9fa9);}[_0x4e6006(0x589,0x53b)](_0x101854,_0x5063de){return[+_0x101854,+_0x5063de,Math['sqrt'](_0x101854*_0x101854+_0x5063de*_0x5063de)];}['getUVByPoint'](_0x55b1eb,_0x5345f5){if(!this[_0x5e218b(0x1ea,0x271)](_0x55b1eb,_0x5345f5))return null;const _0x41b2f0=this['toGridXY'](_0x55b1eb,_0x5345f5);function _0x59335e(_0xf67b06,_0x2c6ba2){return _0x4e6006(_0xf67b06- -0xdf,_0x2c6ba2);}const _0x467e66=this[_0x5e218b(0x2ce,0x273)](_0x41b2f0[0x0],_0x41b2f0[0x1]);function _0x5e218b(_0x8bf63a,_0x246057){return _0x448398(_0x8bf63a,_0x246057- -0xbd);}return _0x467e66;}['isInExtent'](_0x3155f0,_0x3a3dbc){function _0x4ab94e(_0x210002,_0x2dcec2){return _0x448398(_0x210002,_0x2dcec2- -0x117);}function _0xf8d9c9(_0x42fab1,_0x2fed9b){return _0x448398(_0x42fab1,_0x2fed9b-0x11c);}return _0x3155f0>=this[_0xf8d9c9(0x3bf,0x413)]&&_0x3155f0<=this['xmax']&&_0x3a3dbc>=this[_0x4ab94e(0x1e4,0x168)]&&_0x3a3dbc<=this[_0xf8d9c9(0x391,0x3af)]?!![]:![];}['getRandomLatLng'](){function _0x3c12ef(_0x3d4a65,_0x181dd5){return _0x4e6006(_0x3d4a65- -0x35a,_0x181dd5);}function _0x4a8a24(_0x2ee2eb,_0x2da391){return _0x448398(_0x2da391,_0x2ee2eb-0x180);}const _0x25f0a7=fRandomByfloat(this[_0x4a8a24(0x477,0x402)],this[_0x3c12ef(0x1ba,0x19f)]),_0x5427cf=fRandomByfloat(this['ymin'],this[_0x4a8a24(0x413,0x3ce)]),_0x1f8068={};return _0x1f8068['lat']=_0x5427cf,_0x1f8068['lng']=_0x25f0a7,_0x1f8068;}[_0x448398(0x256,0x2d8)](){let _0x4dbc64,_0x1209fa,_0x320990;function _0x4ab1cb(_0x22ee91,_0x3e97e1){return _0x448398(_0x22ee91,_0x3e97e1- -0x1d6);}for(let _0x5079d1=0x0,_0x1fea24=this[_0x25ec56(0x24c,0x1f9)]['length'];_0x5079d1<_0x1fea24;_0x5079d1++){let _0x3823cd=this['particles'][_0x5079d1];_0x3823cd['age']<=0x0&&(_0x3823cd=this['_randomParticle'](_0x3823cd));if(_0x3823cd['age']>0x0){const _0x49339=_0x3823cd['tlng'],_0x52c16d=_0x3823cd[_0x25ec56(0x17c,0x1b4)];_0x320990=this['getUVByPoint'](_0x49339,_0x52c16d),_0x320990?(_0x4dbc64=_0x49339+this[_0x4ab1cb(0x12c,0x165)][0x0]*_0x320990[0x0],_0x1209fa=_0x52c16d+this['_calc_speedRate'][0x1]*_0x320990[0x1],_0x3823cd['lng']=_0x49339,_0x3823cd[_0x4ab1cb(0x1dc,0x166)]=_0x52c16d,_0x3823cd['tlng']=_0x4dbc64,_0x3823cd['tlat']=_0x1209fa,_0x3823cd[_0x25ec56(0x1b7,0x23e)]=_0x320990[0x2],_0x3823cd[_0x4ab1cb(0x119,0x15c)]--):_0x3823cd['age']=0x0;}}function _0x25ec56(_0x5ba10a,_0x50051d){return _0x4e6006(_0x50051d- -0x37a,_0x5ba10a);}return this[_0x25ec56(0x261,0x1f9)];}['_randomParticle'](_0x47236e){let _0x68e151,_0x4b7c50;for(let _0x364fc4=0x0;_0x364fc4<0x1e;_0x364fc4++){_0x68e151=this['getRandomLatLng'](),_0x4b7c50=this[_0x5076c6(-0xc8,-0xb6)](_0x68e151[_0x28467d(0x1c0,0x13f)],_0x68e151['lat']);if(_0x4b7c50&&_0x4b7c50[0x2]>0x0)break;}if(!_0x4b7c50)return _0x47236e;const _0x12a1d8=_0x68e151['lng']+this['_calc_speedRate'][0x0]*_0x4b7c50[0x0];function _0x28467d(_0xb2f520,_0x10df9e){return _0x448398(_0xb2f520,_0x10df9e- -0x144);}const _0x46c243=_0x68e151['lat']+this[_0x5076c6(-0x100,-0xf6)][0x1]*_0x4b7c50[0x1];_0x47236e['lng']=_0x68e151['lng'],_0x47236e['lat']=_0x68e151[_0x28467d(0x1f5,0x1f8)];function _0x5076c6(_0xa33308,_0x4c3e55){return _0x448398(_0xa33308,_0x4c3e55- -0x431);}return _0x47236e['tlng']=_0x12a1d8,_0x47236e['tlat']=_0x46c243,_0x47236e[_0x5076c6(-0x84,-0xff)]=Math[_0x5076c6(-0x130,-0x12e)](Math[_0x28467d(0x112,0x138)]()*this[_0x5076c6(-0x14f,-0x1a2)]),_0x47236e['speed']=_0x4b7c50[0x2],_0x47236e;}[_0x448398(0x2a2,0x32b)](){for(const _0x6c89e2 in this){delete this[_0x6c89e2];}}}function fRandomByfloat(_0x13cd12,_0x3fac13){function _0x1f72ea(_0x3fdaef,_0x722da5){return _0x448398(_0x722da5,_0x3fdaef- -0x408);}return _0x13cd12+Math[_0x1f72ea(-0x18c,-0x1ca)]()*(_0x3fac13-_0x13cd12);}const Cesium=mars3d__namespace[_0x448398(0x332,0x2d0)],BaseLayer=mars3d__namespace['layer']['BaseLayer'];class CanvasWindLayer extends BaseLayer{constructor(_0x25ee8a={}){super(_0x25ee8a);function _0x374c52(_0x5024d6,_0x2ab125){return _0x448398(_0x2ab125,_0x5024d6- -0x152);}this[_0x125e74(0x3d9,0x38b)](_0x25ee8a),this['canvas']=null;function _0x125e74(_0x2cef7e,_0x3d54f8){return _0x448398(_0x2cef7e,_0x3d54f8-0x11);}_0x25ee8a[_0x125e74(0x30e,0x2dd)]&&_0x25ee8a['steps']&&(this['_colorRamp']=new mars3d__namespace[(_0x125e74(0x2e3,0x288))](_0x25ee8a));}[_0x4e6006(0x616,0x694)](_0x11384d,_0x463eab){function _0x39dc90(_0x2a6416,_0x22b3ed){return _0x4e6006(_0x2a6416- -0x2af,_0x22b3ed);}this[_0x32d1a1(0x19e,0x18e)]=0x3e8/(_0x11384d[_0x32d1a1(0x1f5,0x214)]||0xa),this['_pointerEvents']=this[_0x39dc90(0x348,0x3c4)]['pointerEvents']??![],this['color']=_0x11384d['color']||'#ffffff',this[_0x32d1a1(0x1e0,0x1db)]=_0x11384d[_0x39dc90(0x31a,0x368)]||0x1,this[_0x39dc90(0x2c9,0x2e7)]=_0x11384d[_0x39dc90(0x2c9,0x265)]??0x0;function _0x32d1a1(_0x4ce7b7,_0x403f58){return _0x4e6006(_0x403f58- -0x3ee,_0x4ce7b7);}this['reverseY']=_0x11384d[_0x32d1a1(0x1ad,0x1be)]??![],this['windField']&&this['windField'][_0x39dc90(0x341,0x312)](_0x11384d);}get['layer'](){return this['canvas'];}get['canvasWidth'](){function _0x203c8b(_0x43e01a,_0x139827){return _0x448398(_0x43e01a,_0x139827- -0x9);}return this['_map']['scene']['canvas'][_0x203c8b(0x282,0x2ab)];}get['canvasHeight'](){function _0x47e8a5(_0x1026b6,_0x39f11b){return _0x448398(_0x39f11b,_0x1026b6- -0xc);}return this['_map']['scene'][_0x47e8a5(0x28d,0x218)]['clientHeight'];}get['pointerEvents'](){function _0x301e33(_0x28fdbd,_0x7e1c1b){return _0x448398(_0x7e1c1b,_0x28fdbd- -0x490);}return this[_0x301e33(-0x1dd,-0x168)];}set['pointerEvents'](_0x28b44b){function _0x522b63(_0x327468,_0x146566){return _0x448398(_0x327468,_0x146566-0x1f7);}function _0x1b32fc(_0x56ebc4,_0x25266b){return _0x448398(_0x56ebc4,_0x25266b- -0x14c);}this['_pointerEvents']=_0x28b44b;if(!this['canvas'])return;_0x28b44b?this['canvas'][_0x1b32fc(0x1f4,0x173)]['pointer-events']=_0x522b63(0x5c6,0x55c):this['canvas'][_0x522b63(0x4ac,0x4b6)][_0x1b32fc(0x23d,0x229)]=_0x522b63(0x4ae,0x515);}get['particlesNumber'](){function _0x2fea3d(_0x21b6b7,_0x4ef0fe){return _0x4e6006(_0x4ef0fe- -0x71c,_0x21b6b7);}return this[_0x2fea3d(-0x1af,-0x125)]['particlesNumber'];}set['particlesNumber'](_0x1e7de3){this[_0x4a906a(0x28b,0x218)]['particlesNumber']=_0x1e7de3,clearTimeout(this[_0x216372(0x1fd,0x1ad)]);function _0x216372(_0xa2602e,_0x3d6b13){return _0x448398(_0xa2602e,_0x3d6b13- -0x160);}function _0x4a906a(_0x1aac6b,_0xa3f754){return _0x448398(_0xa3f754,_0x1aac6b- -0xd0);}this[_0x216372(0x18a,0x1ad)]=setTimeout(()=>{this['redraw']();},0x1f4);}get[_0x4e6006(0x546,0x516)](){function _0x447e49(_0x291640,_0x3afc36){return _0x4e6006(_0x291640- -0x272,_0x3afc36);}return this['options'][_0x447e49(0x2d4,0x35a)];}set[_0x448398(0x266,0x2aa)](_0x129798){this['options']['speedRate']=_0x129798,this['windField']&&(this['windField']['speedRate']=_0x129798);}get[_0x448398(0x2ef,0x28f)](){function _0x4a0035(_0x54d160,_0x2774f8){return _0x4e6006(_0x54d160- -0x5f1,_0x2774f8);}function _0xdc9809(_0x1f3fe8,_0x53f3f0){return _0x4e6006(_0x1f3fe8- -0x1f3,_0x53f3f0);}return this[_0xdc9809(0x404,0x3e2)][_0xdc9809(0x338,0x3be)];}set['maxAge'](_0x1fb2c0){function _0x4cef4b(_0x3c1e74,_0x37dc5d){return _0x4e6006(_0x3c1e74- -0x596,_0x37dc5d);}function _0x1a377a(_0x16f7eb,_0x54f7d2){return _0x4e6006(_0x16f7eb- -0x1c,_0x54f7d2);}this[_0x4cef4b(0x61,-0x18)][_0x4cef4b(-0x6b,0xa)]=_0x1fb2c0,this[_0x4cef4b(0x46,0xca)]&&(this[_0x1a377a(0x5c0,0x59e)]['maxAge']=_0x1fb2c0);}get['data'](){return this['windData'];}set['data'](_0x857089){this['setData'](_0x857089);}[_0x448398(0x359,0x350)](_0x440561){function _0xbd8d78(_0x404c67,_0x19e347){return _0x448398(_0x404c67,_0x19e347- -0x285);}function _0x43960b(_0x3c915d,_0x34ddce){return _0x448398(_0x3c915d,_0x34ddce- -0x46b);}_0x440561?this[_0xbd8d78(0x99,0xa0)]():(this[_0x43960b(-0x17e,-0x152)]&&(this['options']['data']=this[_0xbd8d78(0x8,0x94)]),this['_removedHook']());}['_mountedHook'](){function _0x6a90d2(_0x3ff1ef,_0x2d344e){return _0x4e6006(_0x3ff1ef- -0x78c,_0x2d344e);}this['options']['worker']?this['initWorker']():this['windField']=new CanvasWindField(this[_0x6a90d2(-0x195,-0x1f9)]);}['_addedHook'](){this['canvas']=this[_0x5027cd(0x4f9,0x4ed)]();const _0x3a156e={};_0x3a156e[_0x4380e0(0x33e,0x342)]=!![];function _0x5027cd(_0x369a36,_0x4d0854){return _0x4e6006(_0x4d0854- -0xd6,_0x369a36);}this['canvasContext']=this['canvas']['getContext']('2d',_0x3a156e),this['bindEvent']();function _0x4380e0(_0x3ce848,_0x2b51db){return _0x448398(_0x2b51db,_0x3ce848-0x3f);}this['options']['data']&&this['setData'](this[_0x5027cd(0x598,0x521)]['data']);}[_0x448398(0x2ef,0x2ef)](){function _0x2a578f(_0x3c6610,_0x56ee0){return _0x448398(_0x3c6610,_0x56ee0- -0x352);}this['clear'](),this[_0x2a578f(-0xf8,-0xe0)]();function _0x5017dd(_0xdbfbb9,_0x2d0710){return _0x4e6006(_0xdbfbb9- -0x1e7,_0x2d0710);}this['canvas']&&(this['_map'][_0x2a578f(-0x88,-0x32)]['removeChild'](this['canvas']),delete this[_0x5017dd(0x34e,0x2fb)]);}['_createCanvas'](){function _0x20cbe3(_0x3f9a3e,_0x3f1510){return _0x4e6006(_0x3f9a3e- -0x353,_0x3f1510);}const _0x476de9=mars3d__namespace['DomUtil'][_0x877c0(0x552,0x5d3)](_0x20cbe3(0x1e2,0x247),'mars3d-canvasWind',this[_0x877c0(0x57d,0x598)][_0x20cbe3(0x269,0x21d)]);function _0x877c0(_0x45873f,_0x239db0){return _0x4e6006(_0x45873f- -0x53,_0x239db0);}return _0x476de9[_0x877c0(0x508,0x581)][_0x877c0(0x555,0x504)]=_0x877c0(0x5cb,0x5eb),_0x476de9['style']['top']=_0x877c0(0x500,0x56b),_0x476de9['style']['left']=_0x20cbe3(0x200,0x237),_0x476de9['style']['width']=this['_map'][_0x20cbe3(0x271,0x2a3)][_0x20cbe3(0x1e2,0x219)][_0x20cbe3(0x1fd,0x19c)]+'px',_0x476de9[_0x877c0(0x508,0x57c)][_0x877c0(0x5bf,0x55b)]=this['_map']['scene']['canvas']['clientHeight']+'px',_0x476de9['style']['pointerEvents']=this[_0x877c0(0x4fc,0x55a)]?'auto':'none',_0x476de9[_0x877c0(0x508,0x516)][_0x877c0(0x50b,0x58a)]=this['options']['zIndex']??0x9,_0x476de9[_0x20cbe3(0x282,0x2c1)]=this['_map']['scene']['canvas']['clientWidth'],_0x476de9[_0x877c0(0x5bf,0x5fe)]=this[_0x20cbe3(0x27d,0x242)][_0x877c0(0x571,0x572)]['canvas']['clientHeight'],_0x476de9;}['resize'](){function _0x56eca6(_0x431c9d,_0x46a9a0){return _0x448398(_0x46a9a0,_0x431c9d- -0x2c4);}function _0x129461(_0x2acab4,_0x34fb1f){return _0x4e6006(_0x34fb1f- -0x788,_0x2acab4);}this[_0x56eca6(-0x2b,-0x9a)]&&(this[_0x56eca6(-0x2b,0x7)][_0x129461(-0x1b3,-0x22d)]['width']=this[_0x129461(-0x172,-0x1b8)][_0x129461(-0x208,-0x1c4)][_0x56eca6(-0x2b,-0x1a)][_0x56eca6(-0x10,0x6a)]+'px',this['canvas'][_0x129461(-0x25d,-0x22d)]['height']=this['_map'][_0x129461(-0x153,-0x1c4)][_0x129461(-0x274,-0x253)][_0x129461(-0x229,-0x1ad)]+'px',this['canvas']['width']=this[_0x56eca6(0x70,0x9b)][_0x56eca6(0x64,0xb9)][_0x129461(-0x29f,-0x253)][_0x56eca6(-0x10,-0x5)],this['canvas']['height']=this['_map'][_0x129461(-0x1a2,-0x1c4)]['canvas'][_0x56eca6(0x7b,0x4a)]);}['bindEvent'](){const _0x256fe6=this;let _0x253bfc=Date['now']();function _0x1cff31(_0x1a7f59,_0x40e68e){return _0x4e6006(_0x1a7f59- -0x38f,_0x40e68e);}(function _0x5296ae(){if(_0x256fe6[_0x5aa04b(0x546,0x4be)])return;function _0x3059f7(_0x1fb76d,_0x109058){return _0x492e(_0x109058-0x2a8,_0x1fb76d);}_0x256fe6[_0x3059f7(0x44a,0x498)]=window['requestAnimationFrame'](_0x5296ae);function _0x5aa04b(_0x6f85b8,_0x209f18){return _0x492e(_0x6f85b8-0x336,_0x209f18);}if(_0x256fe6[_0x3059f7(0x440,0x482)]&&_0x256fe6['windField']){const _0x974025=Date[_0x5aa04b(0x4e8,0x4b3)](),_0x1618ed=_0x974025-_0x253bfc;_0x1618ed>_0x256fe6['frameTime']&&(_0x253bfc=_0x974025-_0x1618ed%_0x256fe6['frameTime'],_0x256fe6['update']());}}(),window[_0x58b21c(0x1df,0x1ff)]('resize',this[_0x58b21c(0x11a,0x158)][_0x1cff31(0x1a2,0x18b)](this),![]));function _0x58b21c(_0x505b42,_0x3b6a89){return _0x4e6006(_0x3b6a89- -0x405,_0x505b42);}this['mouse_down']=![],this['mouse_move']=![],this[_0x58b21c(0x278,0x1f2)][_0x1cff31(0x250,0x264)]&&(this[_0x1cff31(0x241,0x239)]['on'](mars3d__namespace[_0x58b21c(0x12b,0x1b6)][_0x58b21c(0x142,0x139)],this[_0x1cff31(0x1a8,0x1a7)],this),this['_map']['on'](mars3d__namespace[_0x58b21c(0x1c0,0x1b6)]['mouseDown'],this['_onMouseDownEvent'],this),this['_map']['on'](mars3d__namespace['EventType'][_0x1cff31(0x18d,0x1ba)],this['_onMouseUpEvent'],this));}['unbindEvent'](){function _0x392d8c(_0x1665a1,_0x2f0768){return _0x4e6006(_0x2f0768- -0xd9,_0x1665a1);}window['cancelAnimationFrame'](this[_0x3a685d(-0x1e2,-0x1d5)]);function _0x3a685d(_0x37f83b,_0x404be6){return _0x448398(_0x37f83b,_0x404be6- -0x4f6);}delete this['_animateFrame'],window['removeEventListener']('resize',this[_0x3a685d(-0x24c,-0x235)]),this['options']['mouseHidden']&&(this[_0x3a685d(-0x205,-0x1c2)]['off'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map']['off'](mars3d__namespace[_0x3a685d(-0x233,-0x1d7)][_0x3a685d(-0x257,-0x23b)],this['_onMouseDownEvent'],this),this[_0x392d8c(0x549,0x4f7)]['off'](mars3d__namespace['EventType']['mouseUp'],this[_0x3a685d(-0x196,-0x1f4)],this),this[_0x392d8c(0x497,0x4f7)][_0x392d8c(0x3cf,0x441)](mars3d__namespace[_0x3a685d(-0x210,-0x1d7)]['mouseMove'],this[_0x392d8c(0x44c,0x4a5)],this));}['_onMapWhellEvent'](_0x5b5f83){clearTimeout(this[_0x49f4f4(-0x12e,-0x158)]);function _0x49f4f4(_0xaa4bed,_0x328f64){return _0x4e6006(_0xaa4bed- -0x6e0,_0x328f64);}if(!this[_0x3cbaeb(-0x100,-0x143)]||!this[_0x3cbaeb(-0x189,-0x1b5)])return;function _0x3cbaeb(_0xf7aaf1,_0x2bf590){return _0x4e6006(_0x2bf590- -0x6ea,_0xf7aaf1);}this[_0x49f4f4(-0x1ab,-0x226)][_0x3cbaeb(-0x1a1,-0x18f)]['visibility']='hidden',this[_0x49f4f4(-0x12e,-0x13f)]=setTimeout(()=>{if(!this['show'])return;this['redraw']();function _0x11a981(_0x7e0c5a,_0x290b4f){return _0x3cbaeb(_0x290b4f,_0x7e0c5a-0x567);}this[_0x11a981(0x3b2,0x394)]['style']['visibility']='visible';},0xc8);}['_onMouseDownEvent'](_0xd39112){this['mouse_down']=!![];function _0x34dc1d(_0x393096,_0x29f5fc){return _0x4e6006(_0x29f5fc- -0x467,_0x393096);}this['_map']['off'](mars3d__namespace['EventType'][_0x34dc1d(0xd8,0xea)],this['_onMouseMoveEvent'],this),this['_map']['on'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this);}[_0x4e6006(0x57e,0x51b)](_0x12cbf9){function _0x186e68(_0x4176ca,_0x5c0c13){return _0x4e6006(_0x4176ca- -0x12,_0x5c0c13);}function _0x582d3f(_0x13f7c4,_0x1a2802){return _0x448398(_0x1a2802,_0x13f7c4-0x169);}if(!this[_0x186e68(0x595,0x594)]||!this[_0x186e68(0x523,0x4d0)])return;this[_0x186e68(0x54a,0x58b)]&&(this[_0x186e68(0x523,0x502)]['style'][_0x186e68(0x5ad,0x5fc)]='hidden',this['mouse_move']=!![]);}[_0x4e6006(0x59e,0x57d)](_0x417c5e){if(!this[_0x228dd1(0x219,0x29a)]||!this['canvas'])return;function _0x36ce08(_0x25b81a,_0x16ebb9){return _0x4e6006(_0x16ebb9- -0x68b,_0x25b81a);}function _0x228dd1(_0x143d87,_0x539613){return _0x4e6006(_0x539613- -0x30d,_0x143d87);}this['_map']['off'](mars3d__namespace['EventType'][_0x36ce08(-0x112,-0x13a)],this[_0x228dd1(0x24f,0x271)],this),this['mouse_down']&&this['mouse_move']&&this[_0x36ce08(-0x18b,-0x107)](),this[_0x228dd1(0x1fd,0x228)]['style']['visibility']='visible',this[_0x36ce08(-0x158,-0x12f)]=![],this['mouse_move']=![];}['setData'](_0xaa36c9){this['clear']();function _0x443cfa(_0x404dbf,_0x30225e){return _0x448398(_0x30225e,_0x404dbf- -0x119);}function _0x20ab81(_0xa84e60,_0x2838b9){return _0x448398(_0xa84e60,_0x2838b9- -0x206);}this[_0x20ab81(0xdd,0x113)]=_0xaa36c9,this['windField']['setDate'](_0xaa36c9),this[_0x443cfa(0x1cf,0x23e)]();}[_0x448398(0x2d9,0x2e8)](){if(!this[_0x10f853(0x3ce,0x3d0)])return;function _0x10f853(_0x144207,_0x2e3e72){return _0x448398(_0x144207,_0x2e3e72-0xc5);}function _0x556b57(_0x46ec50,_0x556076){return _0x448398(_0x556076,_0x46ec50- -0x1ac);}this[_0x10f853(0x3a6,0x405)]['setOptions'](this[_0x10f853(0x3db,0x420)]),this['update']();}['update'](){function _0x24cf99(_0x415aaa,_0x3f9824){return _0x4e6006(_0x415aaa- -0x2bc,_0x3f9824);}function _0x5b763e(_0x4f8b37,_0x4c2d98){return _0x448398(_0x4c2d98,_0x4f8b37- -0x319);}if(this[_0x5b763e(-0x4c,-0xbe)])return;this[_0x24cf99(0x2ad,0x2e8)]=!![];if(this[_0x5b763e(0x5b,-0x6)])this[_0x24cf99(0x320,0x2b6)][_0x24cf99(0x36a,0x36f)]();else{const _0x157fd3=this[_0x24cf99(0x320,0x36f)][_0x24cf99(0x2b8,0x2c8)]();this['_drawLines'](_0x157fd3);}this['_updateIng']=![];}['_drawLines'](_0x41f3ab){this['canvasContext'][_0x5d823b(0x455,0x3f9)]='destination-in',this['canvasContext'][_0x5d823b(0x438,0x3f5)](0x0,0x0,this[_0x5d823b(0x497,0x491)],this[_0x5d823b(0x481,0x4ad)]),this['canvasContext']['globalCompositeOperation']='lighter',this['canvasContext']['globalAlpha']=0.9;const _0x4ef814=this['_map'][_0x5d823b(0x46c,0x425)][_0x5d823b(0x488,0x410)]!==Cesium[_0xb5af78(0x460,0x4a7)]['SCENE3D'];function _0xb5af78(_0x353957,_0x3e53cb){return _0x448398(_0x3e53cb,_0x353957-0x119);}const _0x597d17=this['canvasWidth']*0.25;function _0x5d823b(_0x34827f,_0x477411){return _0x448398(_0x477411,_0x34827f-0x144);}if(this['_colorRamp'])for(let _0x2f677c=0x0,_0x5c28ab=_0x41f3ab[_0xb5af78(0x3b8,0x363)];_0x2f677c<_0x5c28ab;_0x2f677c++){const _0x39fe3c=_0x41f3ab[_0x2f677c],_0x21e54e=this['_tomap'](_0x39fe3c['lng'],_0x39fe3c[_0x5d823b(0x480,0x4db)],_0x39fe3c),_0x3ee1aa=this['_tomap'](_0x39fe3c['tlng'],_0x39fe3c['tlat'],_0x39fe3c);if(!_0x21e54e||!_0x3ee1aa)continue;if(_0x4ef814&&Math[_0x5d823b(0x4af,0x476)](_0x21e54e[0x0]-_0x3ee1aa[0x0])>=_0x597d17)continue;this['canvasContext']['beginPath'](),this['canvasContext'][_0xb5af78(0x446,0x4a2)]=this['lineWidth'],this[_0x5d823b(0x425,0x3c6)]['strokeStyle']=this['_colorRamp']['getColor'](_0x39fe3c['speed']),this[_0x5d823b(0x425,0x3a1)]['moveTo'](_0x21e54e[0x0],_0x21e54e[0x1]),this[_0x5d823b(0x425,0x44f)]['lineTo'](_0x3ee1aa[0x0],_0x3ee1aa[0x1]),this[_0xb5af78(0x3fa,0x3fd)]['stroke']();}else{this[_0xb5af78(0x3fa,0x484)]['beginPath'](),this['canvasContext']['lineWidth']=this['lineWidth'],this['canvasContext']['strokeStyle']=this['color'];for(let _0x1f932f=0x0,_0x1898e5=_0x41f3ab['length'];_0x1f932f<_0x1898e5;_0x1f932f++){const _0x5c6eed=_0x41f3ab[_0x1f932f],_0x567c71=this['_tomap'](_0x5c6eed['lng'],_0x5c6eed[_0x5d823b(0x480,0x48e)],_0x5c6eed),_0x1bc9c6=this['_tomap'](_0x5c6eed['tlng'],_0x5c6eed['tlat'],_0x5c6eed);if(!_0x567c71||!_0x1bc9c6)continue;if(_0x4ef814&&Math['abs'](_0x567c71[0x0]-_0x1bc9c6[0x0])>=_0x597d17)continue;this['canvasContext'][_0xb5af78(0x416,0x40f)](_0x567c71[0x0],_0x567c71[0x1]),this[_0x5d823b(0x425,0x4ad)]['lineTo'](_0x1bc9c6[0x0],_0x1bc9c6[0x1]);}this['canvasContext']['stroke']();}}[_0x448398(0x370,0x369)](_0x6cda03,_0xfb7f3f,_0x170d1b){const _0x2e6eb7=Cesium[_0x4216a5(0x3f5,0x38d)]['fromDegrees'](_0x6cda03,_0xfb7f3f,this['fixedHeight']),_0x242b78=this[_0x3d377e(0x23f,0x1eb)]['scene'];if(_0x242b78[_0x4216a5(0x3b0,0x409)]===Cesium[_0x4216a5(0x3cc,0x40c)]['SCENE3D']){const _0x226c6b=new Cesium[(_0x3d377e(0xc0,0x12d))](_0x242b78['globe']['ellipsoid'],_0x242b78[_0x3d377e(0x194,0x141)]['positionWC']),_0x3a97ed=_0x226c6b[_0x4216a5(0x352,0x375)](_0x2e6eb7);if(!_0x3a97ed)return _0x170d1b['age']=0x0,null;}const _0x468baf=mars3d__namespace[_0x4216a5(0x3c3,0x403)][_0x3d377e(0x204,0x215)](this[_0x3d377e(0x230,0x1eb)][_0x3d377e(0x243,0x1df)],_0x2e6eb7);function _0x4216a5(_0xc41661,_0x444d9d){return _0x448398(_0xc41661,_0x444d9d-0xc5);}function _0x3d377e(_0x2f462b,_0x4252ed){return _0x448398(_0x2f462b,_0x4252ed- -0x149);}return _0x468baf?[_0x468baf['x'],_0x468baf['y']]:null;}['clear'](){function _0x2b73a6(_0x1f0e11,_0x436951){return _0x448398(_0x1f0e11,_0x436951- -0x3d);}this[_0x2b73a6(0x2fd,0x303)][_0x2b73a6(0x3b6,0x332)]();function _0x9ab2bf(_0x2c8225,_0x3c36b3){return _0x448398(_0x3c36b3,_0x2c8225- -0x17d);}delete this['windData'];}['initWorker'](){this['worker']=new Worker(this['options'][_0x1359f0(0x398,0x40b)]),this['worker']['onmessage']=_0x2b6ec4=>{function _0x3255d9(_0x4dfa73,_0x6efee){return _0x1359f0(_0x6efee,_0x4dfa73- -0x537);}function _0x39787e(_0x50939c,_0x561eae){return _0x1359f0(_0x50939c,_0x561eae- -0x2c4);}this['_drawLines'](_0x2b6ec4['data'][_0x39787e(0x135,0xaa)]),this[_0x3255d9(-0x1a7,-0x139)]=![];},this['windField']={'init':_0x52c4a4=>{const _0x9fb3f8={};function _0x5a84e3(_0x1f13e2,_0x5895e9){return _0x1359f0(_0x1f13e2,_0x5895e9- -0x59f);}_0x9fb3f8[_0x5a84e3(-0x256,-0x203)]='init',_0x9fb3f8['options']=_0x52c4a4;function _0x25ac68(_0x5b1388,_0xc12f58){return _0x1359f0(_0x5b1388,_0xc12f58- -0x2c);}this['worker'][_0x5a84e3(-0x243,-0x202)](_0x9fb3f8);},'setOptions':_0x2774e2=>{function _0x14159c(_0x1f5836,_0x512c79){return _0x1359f0(_0x512c79,_0x1f5836-0x61);}function _0x27ee76(_0x2c9534,_0x18336f){return _0x1359f0(_0x2c9534,_0x18336f- -0x572);}const _0x3060f6={};_0x3060f6[_0x14159c(0x3fd,0x3de)]='setOptions',_0x3060f6['options']=_0x2774e2,this['worker'][_0x14159c(0x3fe,0x439)](_0x3060f6);},'setDate':_0x2cf5a3=>{function _0x4b2262(_0x3fc29a,_0x46992d){return _0x1359f0(_0x3fc29a,_0x46992d- -0x165);}const _0x2a7be1={};function _0x2bae49(_0x26ab28,_0xa34c44){return _0x1359f0(_0xa34c44,_0x26ab28-0x1f1);}_0x2a7be1['type']='setDate',_0x2a7be1[_0x4b2262(0x249,0x1cc)]=_0x2cf5a3,this[_0x4b2262(0x258,0x2a6)][_0x4b2262(0x270,0x238)](_0x2a7be1);},'update':()=>{function _0x12242e(_0x447cda,_0x39b3ca){return _0x1359f0(_0x447cda,_0x39b3ca-0x15c);}if(this['_updateIng2'])return;this['_updateIng2']=!![];const _0x3ade1b={};function _0x4c8c51(_0x151473,_0x33049b){return _0x1359f0(_0x151473,_0x33049b- -0x14a);}_0x3ade1b[_0x4c8c51(0x221,0x252)]=_0x4c8c51(0x255,0x2d7),this['worker'][_0x4c8c51(0x2dc,0x253)](_0x3ade1b);},'clear':()=>{function _0x236e54(_0x521bc5,_0x1581c4){return _0x1359f0(_0x521bc5,_0x1581c4- -0x82);}const _0x58cdfa={};function _0x28ea66(_0x1fc568,_0x84e81e){return _0x1359f0(_0x84e81e,_0x1fc568-0xf);}_0x58cdfa['type']='clear',this[_0x236e54(0x395,0x389)][_0x236e54(0x342,0x31b)](_0x58cdfa);}};function _0x1359f0(_0x473394,_0x2801f8){return _0x4e6006(_0x2801f8- -0x205,_0x473394);}this['windField']['init'](this['options']);}}mars3d__namespace[_0x448398(0x32f,0x331)][_0x4e6006(0x57b,0x5da)]('canvasWind',CanvasWindLayer),mars3d__namespace['layer']['CanvasWindLayer']=CanvasWindLayer;function _0x448398(_0x4c4549,_0x4ebf89){return _0x492e(_0x4ebf89-0x131,_0x4c4549);}mars3d__namespace[_0x4e6006(0x5a4,0x5da)]=CanvasWindField,mars3d__namespace[_0x448398(0x247,0x2d1)]=WindUtil,exports['CanvasWindField']=CanvasWindField,exports['CanvasWindLayer']=CanvasWindLayer,exports['WindLayer']=WindLayer,exports[_0x448398(0x347,0x2d1)]=WindUtil;function _0x492e(_0x358d2d,_0x375cbf){const _0x14d63f=_0x14d6();return _0x492e=function(_0x492ef7,_0xbca93d){_0x492ef7=_0x492ef7-0x141;let _0x52e7aa=_0x14d63f[_0x492ef7];return _0x52e7aa;},_0x492e(_0x358d2d,_0x375cbf);}const _0x3d4669={};_0x3d4669['value']=!![],Object[_0x448398(0x2fe,0x362)](exports,_0x4e6006(0x522,0x502),_0x3d4669);
}));
